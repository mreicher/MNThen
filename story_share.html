<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Share Your Story | Minnesota Then</title>
    <link rel="shortcut icon" type="image/jpg" href="images/mnthenfav.ico" /> 
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
      <link rel="stylesheet" href="https://www.mnthen.com/css/new_header.css">
    
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f8f9fa;
            color: #333;
        }

        .hero {
            background-image: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('images/header.jpg');
            background-size: cover;
            background-position: center;
            height: 500px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        .hero h1 {
            font-family: 'Playfair Display', serif;
            font-size: 3.5rem;
        }
        .content {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 3rem;
            margin-top: -100px;
        }
        .headline {
            color: #1a237e;
            margin-bottom: 1.5rem;
            font-family: 'Playfair Display', serif;
        }
        .form-control:focus {
            border-color: #1a237e;
            box-shadow: 0 0 0 0.2rem rgba(26,35,126,.25);
        }
        .btn-primary {
            background-color: #1a237e;
            border-color: #1a237e;
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            background-color: #0d47a1;
            border-color: #0d47a1;
            transform: translateY(-2px);
        }
        .community-guidelines {
            background-color: #e8eaf6;
            border-radius: 8px;
            padding: 2rem;
            margin-top: 3rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        #wordCount {
            font-size: 0.9rem;
            color: #6c757d;
        }

        footer {
            background-color: #1a237e;
            color: white;
            padding: 30px 0;
        }
        .form-group label {
            font-weight: 500;
        }
        .intro {
            font-size: 1.1rem;
            line-height: 1.6;
        }
        .timeline {
            position: relative;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px 0;
        }
        .timeline::after {
            content: '';
            position: absolute;
            width: 6px;
            background-color: #1a237e;
            top: 0;
            bottom: 0;
            left: 50%;
            margin-left: -3px;
        }
        .timeline-item {
            padding: 10px 40px;
            position: relative;
            background-color: inherit;
            width: 50%;
        }
        .timeline-item::after {
            content: '';
            position: absolute;
            width: 25px;
            height: 25px;
            right: -17px;
            background-color: white;
            border: 4px solid #1a237e;
            top: 15px;
            border-radius: 50%;
            z-index: 1;
        }
        .left {
            left: 0;
        }
        .right {
            left: 50%;
        }
        .left::before {
            content: " ";
            height: 0;
            position: absolute;
            top: 22px;
            width: 0;
            z-index: 1;
            right: 30px;
            border: medium solid #1a237e;
            border-width: 10px 0 10px 10px;
            border-color: transparent transparent transparent #1a237e;
        }
        .right::before {
            content: " ";
            height: 0;
            position: absolute;
            top: 22px;
            width: 0;
            z-index: 1;
            left: 30px;
            border: medium solid #1a237e;
            border-width: 10px 10px 10px 0;
            border-color: transparent #1a237e transparent transparent;
        }
        .right::after {
            left: -16px;
        }
        .timeline-content {
            padding: 20px 30px;
            background-color: white;
            position: relative;
            border-radius: 6px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .timeline-date {
            font-weight: bold;
            color: #1a237e;
        }
        #storySubmission {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #storyText {
            width: 100%;
            height: 300px;
            padding: 15px;
            border: 2px solid #1a237e;
            border-radius: 8px;
            font-size: 16px;
            resize: vertical;
        }
        #submitStory {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 18px;
            background-color: #1a237e;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        #submitStory:hover {
            background-color: #0d47a1;
            transform: translateY(-2px);
        }
        .story-prompt {
            font-style: italic;
            color: #6c757d;
            margin-bottom: 10px;
        }
        
        #loginMessage {
            display: none;
            background-color: #f8d7da;
            color: #721c24;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        #emailConsent {
            margin-top: 10px;
        }
    </style>
</head>

<body>
      <!-- Header section -->
  <header>
    <nav class="navbar">
      <div class="navbar-brand">
        <a href="/index.html">
          <!-- <img src="logo.png" alt="Minnesota Then"> -->
          Minnesota Then
        </a>
      </div>
      <a href="#" class="toggle-button">
        <span class="bar"></span>
        <span class="bar"></span>
        <span class="bar"></span>
      </a>
      <div class="navbar-links">
        <ul>
          <li><a href="/blog.html" class="px-1">Blog</a></li>
          <li><a href="/faq.html" class="px-1">Help Center</a></li>
          <li class="dropdown">
            <a href="#" class="px-1 dropdown-toggle">Sponsor Us</a>
            <div class="dropdown-menu">
              <div class="container">
                <a href="/donate.html" class="dropdown-item">
                  <h5>Make a Donation</h5>
                </a>
                <hr class="centered-hr">
                <a href="#" class="dropdown-item">
                  <h5>Join our Patreon</h5>
                </a>
                <hr class="centered-hr">
                <a href="#" class="dropdown-item">
                  <h5>Shop our Online Store</h5>
                </a>
              </div>
            </div>
          </li>
          <li><a href="/upcoming_events.html" class="px-1">Upcoming Events</a></li>
          <li><a href="#" class="donate-btn rounded-pill px-3" id="account-link">
              <i class="fas fa-user"></i>
              <span>Log In <span>|</span> Register</span>
            </a>
          </li>
        </ul>
      </div>
    </nav>
  </header>

    <main>
        <div class="hero">
            <h1 class="text-center">Share Your Story</h1>
        </div>

        <div class="container content">
            <h2 class="headline text-center">Contribute to Minnesota's Rich History</h2>
            <div class="intro mb-5">
                <p>Minnesota Then is dedicated to preserving and sharing the diverse stories that shape our state's rich history. We invite you to contribute your unique perspectives and experiences, whether they're personal anecdotes, family legends, or well-researched historical accounts.</p>
                <p>From the early days of statehood to the present, from small town tales to big city chronicles, from everyday life to extraordinary events - every story adds a valuable thread to the tapestry of Minnesota's history.</p>
            </div>

            <div class="timeline mb-5">
                <div class="timeline-item left">
                    <div class="timeline-content">
                        <h2 class="timeline-date">1858</h2>
                        <p>Minnesota becomes the 32nd state of the United States</p>
                    </div>
                </div>
                <div class="timeline-item right">
                    <div class="timeline-content">
                        <h2 class="timeline-date">1920s</h2>
                        <p>The Roaring Twenties bring cultural changes to Minnesota</p>
                    </div>
                </div>
                <div class="timeline-item left">
                    <div class="timeline-content">
                        <h2 class="timeline-date">1960s</h2>
                        <p>Civil Rights Movement impacts Minnesota communities</p>
                    </div>
                </div>
                <div class="timeline-item right">
                    <div class="timeline-content">
                        <h2 class="timeline-date">Today</h2>
                        <p>Your story becomes part of Minnesota's ongoing history</p>
                    </div>
                </div>
            </div>

            <div id="storySubmission" class="mt-5">
                <h3 class="mb-4">Tell Your Minnesota Story</h3>
                <div id="loginMessage">Please log in to submit your story.</div>
                <p class="story-prompt" id="storyPrompt">Share a memorable experience from your life in Minnesota...</p>
                <textarea id="storyText" placeholder="Start typing your story here..."></textarea>
                <small id="wordCount" class="form-text text-muted mt-2">Word count: 0</small>
                <div id="emailConsent">
                    <input type="checkbox" id="consentCheckbox">
                    <label for="consentCheckbox">I agree to be contacted via email for potential follow-up questions.</label>
                </div>
                <button id="submitStory" disabled>Submit Your Story</button>
            </div>

                        <div class="community-guidelines mt-5">
                <h3><i class="fas fa-users"></i> Community Guidelines</h3>
                <ul class="list-unstyled">
                    <li><i class="fas fa-check text-success"></i> Be respectful and considerate of others in your storytelling.</li>
                    <li><i class="fas fa-check text-success"></i> Ensure your story is factual and verifiable.</li>
                    <li><i class="fas fa-check text-success"></i> Avoid sharing sensitive personal information about living individuals without their consent.</li>
                    <li><i class="fas fa-check text-success"></i> If including images, ensure you have the right to share them.</li>
                    <li><i class="fas fa-check text-success"></i> Be open to feedback and potential edits to your story.</li>
                </ul>
            </div>
        </div>
        </div>
    </main>

    <!-- ... (footer remains unchanged) ... -->

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/emailjs-com@2/dist/email.min.js"></script>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    
    <script>
        // Your web app's Firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyBDUAF3qJGhLYQJPHyWwY0JzonN5l8ERzE",
  authDomain: "mnthen-3151d.firebaseapp.com",
  projectId: "mnthen-3151d",
  storageBucket: "mnthen-3151d.appspot.com",
  messagingSenderId: "416231360428",
  appId: "1:416231360428:web:36f69cc231be2d84a8dc09"
};

// Initialize Firebase
const app = firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();

// Check if user is authenticated
firebase.auth().onAuthStateChanged((user) => {
  const accountLink = document.getElementById('account-link');
  if (user) {
       accountLink.href = '/account.html';
    // User is logged in, update the link text to "Account Info"
    accountLink.innerHTML = '<i class="fas fa-user-circle" style="margin-right: 5px"></i><span> Account Info</span>';
  } else {
      accountLink.href = '/login.html';
    // User is not logged in, revert the link text back to "Log In | Register"
    accountLink.innerHTML = '<i class="fas fa-user" style="margin-right: 5px"></i><span> Log In <span>|</span> Register</span>';
  }
});

const dropdownToggle = document.querySelector('.dropdown-toggle');
const dropdownMenu = document.querySelector('.dropdown-menu');

dropdownToggle.addEventListener('click', function() {
  dropdownMenu.classList.toggle('show');
});

// Add event listener to the entire document
document.addEventListener('click', function(event) {
  // Check if the clicked element is not the dropdown toggle or a child of the dropdown menu
  if (!event.target.matches('.dropdown-toggle') && !event.target.closest('.dropdown-menu')) {
    // If not, close the dropdown menu
    dropdownMenu.classList.remove('show');
  }
});

const toggleButton = document.querySelector('.toggle-button');
const navbarLinks = document.querySelector('.navbar-links');

toggleButton.addEventListener('click', () => {
  navbarLinks.classList.toggle('active');
});

document.addEventListener('click', (event) => {
  const isClickInsideNavbarLinks = navbarLinks.contains(event.target);
  const isClickInsideToggleButton = toggleButton.contains(event.target);

  if (!isClickInsideNavbarLinks && !isClickInsideToggleButton && navbarLinks.classList.contains('active')) {
    navbarLinks.classList.remove('active');
  }
});

    document.addEventListener('DOMContentLoaded', function() {
        var citationIcon = document.getElementById('citationIcon');
        var citationModal = new bootstrap.Modal(document.getElementById('citationModal'));

        citationIcon.addEventListener('click', function() {
            citationModal.show();
        });

        // For desktop: show modal on hover
        if (window.matchMedia("(min-width: 768px)").matches) {
            citationIcon.addEventListener('mouseenter', function() {
                citationModal.show();
            });
        }
    });
        
        
        (function() {
            emailjs.init("YOUR_USER_ID"); // Replace with your EmailJS user ID
        })();

        const storyPrompts = [
            "Share a memorable experience from your life in Minnesota...",
            "Tell us about a historical event that impacted your family or community...",
            "Describe a Minnesota tradition that's important to you...",
            "Recount a story passed down through generations in your family...",
            "Share how a specific place in Minnesota has changed over time..."
        ];

        let isLoggedIn = false; // This should be set based on your authentication system

        function getRandomPrompt() {
            return storyPrompts[Math.floor(Math.random() * storyPrompts.length)];
        }

        function updatePrompt() {
            document.getElementById('storyPrompt').textContent = getRandomPrompt();
        }

        function countWords(str) {
            return str.trim().split(/\s+/).length;
        }

        function updateWordCount() {
            const text = document.getElementById('storyText').value;
            const wordCount = countWords(text);
            document.getElementById('wordCount').textContent = `Word count: ${wordCount}`;
            document.getElementById('submitStory').disabled = !isLoggedIn || wordCount < 300 || wordCount > 500 || !document.getElementById('consentCheckbox').checked;
        }

        document.getElementById('storyText').addEventListener('input', updateWordCount);
        document.getElementById('consentCheckbox').addEventListener('change', updateWordCount);

        document.getElementById('submitStory').addEventListener('click', function() {
            if (!isLoggedIn) {
                document.getElementById('loginMessage').style.display = 'block';
                return;
            }

            const story = document.getElementById('storyText').value;
            
            emailjs.send("YOUR_SERVICE_ID", "YOUR_TEMPLATE_ID", {
                to_email: "your-email@example.com",
                from_name: "Minnesota Then Website",
                message: story
            }).then(
                function(response) {
                    console.log("SUCCESS", response);
                    alert('Thank you for sharing your story! It has been submitted for review.');
                    document.getElementById('storyText').value = '';
                    document.getElementById('consentCheckbox').checked = false;
                    updateWordCount();
                    updatePrompt();
                },
                function(error) {
                    console.log("FAILED", error);
                    alert('There was an error submitting your story. Please try again later.');
                }
            );
        });

        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });

        // Initialize with a random prompt
        updatePrompt();

        // Check login status and update UI
        function checkLoginStatus() {
            // This should be replaced with your actual authentication check
            isLoggedIn = false; // Set this based on your authentication system
            if (!isLoggedIn) {
                document.getElementById('loginMessage').style.display = 'block';
            } else {
                document.getElementById('loginMessage').style.display = 'none';
            }
            updateWordCount();
        }

        // Call this function when the page loads and whenever the login status changes
        checkLoginStatus();
    </script>

    <!-- Bootstrap JS (for modal functionality) -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/5.1.3/js/bootstrap.min.js"></script>
    
</body>

</html>
