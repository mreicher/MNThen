<!DOCTYPE html>

<html lang="en">

<head>

<meta charset="UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Location Details</title>

xml

Copy
<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Font Awesome -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">

<!-- Custom CSS -->
<style>
    body {
        font-family: 'Roboto', sans-serif;
        background-color: #f8f9fa;
        color: #333;
    }
    
    .location-card {
        background-color: #fff;
        border-radius: 15px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        margin-top: 20px;
    }
    
    .location-image {
        width: 100%;
        height: 300px;
        object-fit: cover;
    }
    
    .location-info {
        padding: 20px;
    }
    
    .location-title {
        font-size: 24px;
        font-weight: bold;
        margin-bottom: 10px;
    }
    
    .location-creator, .location-city {
        font-size: 16px;
        color: #6c757d;
    }
    
    .audio-player {
        background-color: #e9ecef;
        border-radius: 10px;
        padding: 15px;
        margin-top: 20px;
    }
    
    .seek-bar {
        width: 100%;
        height: 5px;
        background-color: #ced4da;
        border-radius: 5px;
        margin-bottom: 10px;
        cursor: pointer;
    }
    
    .seek-bar-fill {
        height: 100%;
        background-color: #007bff;
        border-radius: 5px;
        width: 0;
    }
    
    .time-display {
        font-size: 14px;
        color: #6c757d;
        text-align: right;
    }
    
    .control-btn {
        background-color: #007bff;
        color: #fff;
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        font-size: 18px;
        margin: 0 5px;
        transition: background-color 0.3s;
    }
    
    .control-btn:hover {
        background-color: #0056b3;
    }
    
    #return-to-map {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
    }
    
    .bottom-bar {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background-color: #007bff;
        padding: 10px;
        display: flex;
        justify-content: space-around;
    }
    
    .bottom-bar button {
        background: none;
        border: none;
        color: #fff;
        font-size: 20px;
    }
    
    .modal-content {
        border-radius: 15px;
    }
    
    @media (max-width: 768px) {
        .location-image {
            height: 200px;
        }
        
        .location-title {
            font-size: 20px;
        }
        
        .control-btn {
            width: 35px;
            height: 35px;
            font-size: 16px;
        }
    }
</style>
</head>

<body>

<div class="container">

<div class="location-card">

<img id="location-image" class="location-image" src="" alt="Location Image">

<div class="location-info">

<h1 id="location-title" class="location-title"></h1>

<p id="location-city" class="location-city"></p>

<p id="location-creator" class="location-creator"></p>

</div>

<div class="audio-player">

<div class="seek-bar">

<div class="seek-bar-fill"></div>

</div>

<div class="time-display" id="time-display">0:00 / 0:00</div>

<div class="d-flex justify-content-center mt-3">

<button id="rewind-btn" class="control-btn"><i class="fas fa-backward"></i></button>

<button id="play-pause-btn" class="control-btn"><i class="fas fa-play"></i></button>

<button id="forward-btn" class="control-btn"><i class="fas fa-forward"></i></button>

</div>

</div>

</div>

</div>

<button id="return-to-map" class="btn btn-primary"><i class="fas fa-map-marker-alt"></i> Map</button>

<div class="bottom-bar">
    <button id="image-source-btn"><i class="fas fa-image"></i></button>
    <button id="feedback-btn"><i class="fas fa-comment"></i></button>
</div>

<!-- Modals -->
<div class="modal fade" id="image-source-modal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Image Source</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p id="image-source-text"></p>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="feedback-modal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Send Feedback</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p>Click the button below to open your email client and send feedback about this location.</p>
                <button id="send-email-btn" class="btn btn-primary">Open Email Client</button>
            </div>
        </div>
    </div>
</div>

<audio id="location-audio"></audio>

<!-- Bootstrap JS and Popper.js -->
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>

<!-- Custom JS -->
<script src="/locations_test.js"></script>

<script>
document.addEventListener("DOMContentLoaded", function() {
// Utility function to get URL parameters
function getUrlParameter(name) {
name = name.replace(/[]/g, '\$&');
var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
results = regex.exec(window.location.href);
if (!results) return null;
if (!results[2]) return '';
return decodeURIComponent(results[2].replace(/+/g, ' '));
}

// Get location ID from URL
var locationId = getUrlParameter('id');

// Find location data
if (locationId) {
    var location = locations.find(loc => loc.id === locationId);
    if (location) {
        document.getElementById('location-image').src = location.image;
        document.getElementById('location-title').textContent = location.name;
        document.getElementById('location-creator').textContent = 'Creator: ' + location.creator;
        document.getElementById('location-city').textContent = location.city;
        var audioElement = document.getElementById('location-audio');
        audioElement.src = location.audioURL;
        audioElement.load();
        
        // Store the image source for later use
        document.getElementById('location-image').dataset.source = location.imageSource;
    } else {
        document.querySelector('.location-card').innerHTML = '<p>Location not found.</p>';
    }
} else {
    document.querySelector('.location-card').innerHTML = '<p>No location ID provided.</p>';
}

// Audio player functionality
const audio = document.getElementById('location-audio');
const playPauseBtn = document.getElementById('play-pause-btn');
const rewindBtn = document.getElementById('rewind-btn');
const forwardBtn = document.getElementById('forward-btn');
const seekBar = document.querySelector('.seek-bar');
const seekBarFill = document.querySelector('.seek-bar-fill');
const timeDisplay = document.getElementById('time-display');

audio.addEventListener('loadedmetadata', function() {
    timeDisplay.textContent = '0:00 / ' + formatTime(audio.duration);
});

playPauseBtn.addEventListener('click', function() {
    if (audio.paused) {
        audio.play();
        this.innerHTML = '<i class="fas fa-pause"></i>';
    } else {
        audio.pause();
        this.innerHTML = '<i class="fas fa-play"></i>';
    }
});

rewindBtn.addEventListener('click', function() {
    audio.currentTime = Math.max(audio.currentTime - 15, 0);
});

forwardBtn.addEventListener('click', function() {
    audio.currentTime = Math.min(audio.currentTime + 15, audio.duration);
});

audio.addEventListener('timeupdate', function() {
    const percent = (audio.currentTime / audio.duration) * 100;
    seekBarFill.style.width = percent + '%';
    
    if (!isNaN(audio.duration)) {
        timeDisplay.textContent = formatTime(audio.currentTime) + ' / ' + formatTime(audio.duration);
    }
});

seekBar.addEventListener('click', function(e) {
    const percent = (e.offsetX / this.offsetWidth);
    audio.currentTime = percent * audio.duration;
});

function formatTime(seconds) {
    const minutes = Math.floor(seconds / 60);
    seconds = Math.floor(seconds % 60);
    return minutes + ':' + (seconds < 10 ? '0' : '') + seconds;
}

// Exit cooldown functionality
function setExitCooldown() {
    const currentTime = Date.now();
    sessionStorage.setItem('lastTransitionTime', currentTime.toString());
    const locationId = new URLSearchParams(window.location.search).get('id');
    if (locationId) {
        const location = locations.find(loc => loc.id === locationId);
        if (location) {
            const latLngId = location.lat + "," + location.lng;
            sessionStorage.setItem('lastVisitedLocation', latLngId);
        }
    }
}

// Modal functionality
const imageSourceModal = new bootstrap.Modal(document.getElementById('image-source-modal'));
const feedbackModal = new bootstrap.Modal(document.getElementById('feedback-modal'));

document.getElementById('image-source-btn').onclick = function() {
    const location = locations.find(loc => loc.id === locationId);
    if (location && location.imageSource) {
        document.getElementById('image-source-text').textContent = location.imageSource;
        imageSourceModal.show();
    } else {
        alert('Image source not available.');
    }
}

document.getElementById('feedback-btn').onclick = function() {
    feedbackModal.show();
}

// Email functionality
const sendEmailBtn = document.getElementById('send-email-btn');

sendEmailBtn.onclick = function() {
    const location = locations.find(loc => loc.id === locationId);
    let subject = 'Feedback about location';
    let body = 'I have feedback about the following location:\n\n';
    
    if (location) {
        subject += `: ${location.name}`;
        body += `Name: ${location.name}\n`;
        body += `City: ${location.city}\n`;
        body += `Creator: ${location.creator}\n\n`;
    }
    
    body += 'My feedback is:\n\n';
    
    const mailtoLink = `mailto:mattreicher@protonmail.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
    
    window.location.href = mailtoLink;
    feedbackModal.hide();
}

// Return to map functionality
document.getElementById('return-to-map').addEventListener('click', function() {
    setExitCooldown();
    window.location.href = '/example/map.html';
});
});
</script>

</body>

</html>
