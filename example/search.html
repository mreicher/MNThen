<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="Minnesota, history, walking tours, interactive, landmarks, neighborhoods">
  <title>Minnesota Then | Blpg</title>
<link rel="shortcut icon" type="image/x-icon" href="https://www.mnthen.com/images/mnthenfav.ico">
          <link rel="stylesheet" href="https://www.mnthen.com/css/mnthen_header.css">
        <link rel="stylesheet" href="https://www.mnthen.com/css/mnthen_footer.css">

    <!-- Bootstrap 5.3.2 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
/* Custom Styles */
.search-hero {
  background: linear-gradient(to right, #f8f9fa, #e9ecef);
}

.search-form .form-control {
  border-radius: 0.5rem 0 0 0.5rem;
  border: 1px solid #dee2e6;
  padding: 0.75rem 1.25rem;
}

.search-form .btn {
  border-radius: 0 0.5rem 0.5rem 0;
}

.category-filters .btn {
  border-radius: 20px;
  padding: 0.375rem 1rem;
}

.category-filters .btn.active {
  background-color: var(--bs-primary);
  color: white;
}

.time-range {
  padding: 0.5rem 0;
}

/* Result Card Animations */
.result-card {
  transition: transform 0.2s ease-in-out;
}

.result-card:hover {
  transform: translateY(-3px);
}
    </style>
</head>
<body>
<!-- header -->
<header class="site-header">
  <div class="header-container">
    <a href="/" class="site-title">Minnesota Then</a>
    
    <button class="mobile-menu-btn" aria-label="Toggle menu">
      <span></span>
      <span></span>
      <span></span>
    </button>
    
    <nav class="main-nav">
      <ul class="nav-list">
        <li class="nav-item">
          <button class="dropdown-btn">
            About
            <svg class="dropdown-arrow" viewBox="0 0 24 24" width="16" height="16">
              <path d="M7 10l5 5 5-5z"/>
            </svg>
          </button>
          <div class="dropdown-content">
            <a href="/mission">Our Mission</a>
            <a href="/staff">Staff</a>
            <a href="/contact">Contact</a>
          </div>
        </li>
                <li class="nav-item">
          <button class="dropdown-btn">
            Multimedia
            <svg class="dropdown-arrow" viewBox="0 0 24 24" width="16" height="16">
              <path d="M7 10l5 5 5-5z"/>
            </svg>
          </button>
          <div class="dropdown-content">
            <a href="/blog">Blog</a>
            <a href="/youtube">YouTube</a>
            <a href="/podcast">Podcast</a>
          </div>
        </li>
        <li class="nav-item">
          <button class="dropdown-btn">
            Resources
            <svg class="dropdown-arrow" viewBox="0 0 24 24" width="16" height="16">
              <path d="M7 10l5 5 5-5z"/>
            </svg>
          </button>
          <div class="dropdown-content">
            <a href="/exhibits">Current Exhibits</a>
            <a href="/events">Events</a>
            <a href="/resources">Educational Resources</a>
          </div>
        </li>
        <li class="nav-item">
          <button class="dropdown-btn">
            Contribute
            <svg class="dropdown-arrow" viewBox="0 0 24 24" width="16" height="16">
              <path d="M7 10l5 5 5-5z"/>
            </svg>
          </button>
          <div class="dropdown-content">
            <a href="/donate">Donate</a>
            <a href="/volunteer">Volunteer</a>
            <a href="/membership">Membership</a>
          </div>
        </li>
      </ul>
    </nav>
    
    <button class="search-btn" aria-label="Search">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
      </svg>
    </button>
  </div>
</header>
  
<!-- Main Navigation -->
<nav class="mnt-primary-nav navbar navbar-expand-lg py-3">
  <div class="container-fluid px-4">
    <button class="navbar-toggler border-0 shadow-none" type="button" data-bs-toggle="collapse" data-bs-target="#mntMainNavigation" aria-controls="mntMainNavigation" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    
    <div class="collapse navbar-collapse" id="mntMainNavigation">
      <ul class="navbar-nav me-auto align-items-center">
        <li class="nav-item mx-2">
          <a class="mnt-nav-link nav-link position-relative" href="https://www.mnthen.com">
            Home
            <span class="nav-link-underline position-absolute bottom-0 start-0 w-0 transition-all"></span>
          </a>
        </li>
        <li class="nav-item mx-2">
          <a class="mnt-nav-link nav-link position-relative" href="https://mnthen.com/results.html?query=all">
            Index
            <span class="nav-link-underline position-absolute bottom-0 start-0 w-0 transition-all"></span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<!-- Search Hero Section -->
<section class="search-hero py-5 bg-light">
  <div class="container">
    <h1 class="text-center mb-4">Explore Minnesota's History</h1>
    <div class="row justify-content-center">
      <div class="col-lg-8">
        <form id="searchForm" class="search-form">
          <div class="input-group mb-3">
            <input 
              type="search" 
              id="searchInput"
              class="form-control form-control-lg shadow-none"
              placeholder="Search articles, locations, events..."
              aria-label="Search" 
            >
            <button class="btn btn-primary px-4" type="submit">
              <i class="bi bi-search"></i>
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</section>

<!-- Filters Section -->
<section class="filters-section py-4">
  <div class="container">
    <div class="row g-3">
      <!-- Time Period Filter -->
      <div class="col-md-4">
        <div class="card shadow-sm">
          <div class="card-body">
            <h5 class="card-title">Time Period</h5>
            <div class="time-range">
              <input type="range" class="form-range" id="yearRange" min="1700" max="2024" value="2024">
              <div class="d-flex justify-content-between">
                <span class="small text-muted">1700</span>
                <span id="selectedYear" class="small text-primary">2024</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Category Filter -->
      <div class="col-md-8">
        <div class="card shadow-sm">
          <div class="card-body">
            <h5 class="card-title">Categories</h5>
            <div class="category-filters d-flex flex-wrap gap-2">
              <button class="btn btn-outline-primary btn-sm" data-category="people">People</button>
              <button class="btn btn-outline-primary btn-sm" data-category="places">Places</button>
              <button class="btn btn-outline-primary btn-sm" data-category="events">Events</button>
              <button class="btn btn-outline-primary btn-sm" data-category="articles">Articles</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Results Section -->
<section class="results-section py-4">
  <div class="container">
    <div id="searchResults" class="row g-4">
      <!-- Results will be populated here -->
    </div>
    <div id="noResults" class="text-center py-5 d-none">
      <h3>No results found</h3>
      <p class="text-muted">Try adjusting your search terms or filters</p>
    </div>
    <div id="loadingResults" class="text-center py-5 d-none">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>
  </div>
</section>

<!-- Footer Placeholder -->
<footer class="bg-light mt-5 py-4">
  <div class="container-fluid px-4">
    <div class="row">
      <div class="col-md-4">
        <h5>About</h5>
        <p class="text-muted">Footer content will go here</p>
      </div>
      <div class="col-md-4">
        <h5>Links</h5>
        <ul class="list-unstyled">
          <li><a href="#" class="text-decoration-none text-muted">Link 1</a></li>
          <li><a href="#" class="text-decoration-none text-muted">Link 2</a></li>
          <li><a href="#" class="text-decoration-none text-muted">Link 3</a></li>
        </ul>
      </div>
      <div class="col-md-4">
        <h5>Contact</h5>
        <p class="text-muted">Contact information will go here</p>
      </div>
    </div>
  </div>
</footer>

  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

      <!-- Load Firebase SDK -->

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>

<script>
  // Firebase Configuration
import { initializeApp } from 'firebase/app';
import { getFirestore, collection, query, where, getDocs } from 'firebase/firestore';

// Your web app's Firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyBDUAF3qJGhLYQJPHyWwY0JzonN5l8ERzE",
  authDomain: "mnthen-3151d.firebaseapp.com",
  projectId: "mnthen-3151d",
  storageBucket: "mnthen-3151d.appspot.com",
  messagingSenderId: "416231360428",
  appId: "1:416231360428:web:36f69cc231be2d84a8dc09"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// DOM Elements
const searchForm = document.getElementById('searchForm');
const searchInput = document.getElementById('searchInput');
const yearRange = document.getElementById('yearRange');
const selectedYear = document.getElementById('selectedYear');
const categoryButtons = document.querySelectorAll('.category-filters .btn');
const searchResults = document.getElementById('searchResults');
const noResults = document.getElementById('noResults');
const loadingResults = document.getElementById('loadingResults');

// Search State
let activeCategories = new Set();
let currentYear = 2024;

// Event Listeners
searchForm.addEventListener('submit', handleSearch);
yearRange.addEventListener('input', handleYearChange);
categoryButtons.forEach(btn => btn.addEventListener('click', handleCategoryToggle));

// Handle year range changes
function handleYearChange(e) {
  currentYear = e.target.value;
  selectedYear.textContent = currentYear;
  if (searchInput.value) handleSearch(null);
}

// Handle category toggles
function handleCategoryToggle(e) {
  const category = e.target.dataset.category;
  e.target.classList.toggle('active');
  
  if (activeCategories.has(category)) {
    activeCategories.delete(category);
  } else {
    activeCategories.add(category);
  }
  
  if (searchInput.value) handleSearch(null);
}

// Handle search
async function handleSearch(e) {
  if (e) e.preventDefault();
  
  const searchTerm = searchInput.value.trim().toLowerCase();
  if (!searchTerm) return;

  showLoading(true);
  
  try {
    const results = await performSearch(searchTerm);
    displayResults(results);
  } catch (error) {
    console.error('Search error:', error);
    showError();
  }
  
  showLoading(false);
}

// Perform search in Firebase
async function performSearch(searchTerm) {
  const articlesRef = collection(db, 'articles');
  
  // Build query based on filters
  let constraints = [
    where('year', '<=', parseInt(currentYear)),
    where('searchableText', 'array-contains', searchTerm)
  ];
  
  if (activeCategories.size > 0) {
    constraints.push(where('category', 'in', Array.from(activeCategories)));
  }
  
  const q = query(articlesRef, ...constraints);
  const querySnapshot = await getDocs(q);
  
  return querySnapshot.docs.map(doc => ({
    id: doc.id,
    ...doc.data()
  }));
}

// Display results
function displayResults(results) {
  searchResults.innerHTML = '';
  
  if (results.length === 0) {
    noResults.classList.remove('d-none');
    return;
  }
  
  noResults.classList.add('d-none');
  
  results.forEach(result => {
    const resultCard = createResultCard(result);
    searchResults.appendChild(resultCard);
  });
}

// Create result card
function createResultCard(result) {
  const col = document.createElement('div');
  col.className = 'col-md-6 col-lg-4';
  
  col.innerHTML = `
    <div class="card result-card h-100 shadow-sm">
      ${result.imageUrl ? `
        <img src="${result.imageUrl}" class="card-img-top" alt="${result.title}">
      ` : ''}
      <div class="card-body">
        <h5 class="card-title">${result.title}</h5>
        <p class="card-text text-muted">${result.description}</p>
        <div class="d-flex justify-content-between align-items-center">
          <span class="badge bg-primary">${result.category}</span>
          <small class="text-muted">${result.year}</small>
        </div>
      </div>
    </div>
  `;
  
  return col;
}

// Loading state
function showLoading(show) {
  loadingResults.classList.toggle('d-none', !show);
  searchResults.classList.toggle('d-none', show);
}

// Error handling
function showError() {
  searchResults.innerHTML = `
    <div class="col-12 text-center">
      <div class="alert alert-danger">
        An error occurred while searching. Please try again.
      </div>
    </div>
  `;
}
</script>
    
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
