<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Political Bias Analyzer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Add text analysis libraries -->
    <script src="https://cdn.jsdelivr.net/npm/wink-nlp-utils/dist/wink-nlp-utils.min.js"></script>
        <script src="https://unpkg.com/compromise@14.10.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/sentiment@5.0.2/lib/index.min.js"></script>
    
    <style>
        .meter {
            height: 15px;
            background: #e9ecef;
            border-radius: 8px;
            position: relative;
            margin: 10px 0;
        }
        
        .meter-fill {
            height: 100%;
            border-radius: 8px;
            transition: width 0.5s ease;
        }
        
        .bias-meter { background: linear-gradient(to right, #0d6efd, #adb5bd, #dc3545); }
        .emotional-meter { background: linear-gradient(to right, #dc3545, #ffc107, #198754); }
        
        .tag {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 16px;
            margin: 4px;
            font-size: 0.9rem;
            background: #f8f9fa;
        }
        
        .highlight {
            background-color: #ffc10726;
            padding: 2px;
            border-radius: 3px;
        }
        
        .card {
            transition: transform 0.2s;
            margin-bottom: 1rem;
        }
        
        .card:hover {
            transform: translateY(-2px);
        }
    </style>
</head>
<body class="bg-light">
    <div class="container py-4">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <h2 class="mb-4">Political Bias Analyzer</h2>
                        
                        <div class="mb-4">
                            <label class="form-label">Enter political text to analyze:</label>
                            <textarea id="textInput" class="form-control" rows="8" 
                                placeholder="Paste article or political text here..."></textarea>
                            <button id="analyzeBtn" class="btn btn-primary mt-3">
                                Analyze Text
                            </button>
                        </div>

                        <div id="results" class="d-none">
                            <!-- Analysis Results Section -->
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-body">
                                            <h5>Political Bias Analysis</h5>
                                            <div class="meter">
                                                <div id="biasMeter" class="meter-fill bias-meter"></div>
                                            </div>
                                            <div class="d-flex justify-content-between">
                                                <span class="small">Left</span>
                                                <span class="small">Center</span>
                                                <span class="small">Right</span>
                                            </div>
                                            <p id="biasScore" class="mt-2"></p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-body">
                                            <h5>Emotional Content</h5>
                                            <div class="meter">
                                                <div id="emotionalMeter" class="meter-fill emotional-meter"></div>
                                            </div>
                                            <div class="d-flex justify-content-between">
                                                <span class="small">Neutral</span>
                                                <span class="small">Moderate</span>
                                                <span class="small">Emotional</span>
                                            </div>
                                            <p id="emotionalScore" class="mt-2"></p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row mt-3">
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-body">
                                            <h5>Loaded Language</h5>
                                            <div id="loadedTerms"></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-body">
                                            <h5>Key Topics</h5>
                                            <div id="keyTopics"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="card mt-3">
                                <div class="card-body">
                                    <h5>Annotated Text</h5>
                                    <div id="annotatedText" class="mt-3"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
class BiasAnalyzer {
    constructor() {
        this.biasTerms = {
            left: new Set([
                'progressive', 'liberal', 'regulation', 'welfare', 'socialist',
                'workers', 'unions', 'equality', 'reform', 'public', 'collective'
            ]),
            right: new Set([
                'conservative', 'traditional', 'freedom', 'market', 'individual',
                'liberty', 'private', 'faith', 'patriot', 'values', 'tax cuts'
            ])
        };
        
        this.loadedLanguage = new Set([
            'radical', 'extreme', 'dangerous', 'threatening', 'disaster',
            'crisis', 'destructive', 'devastating', 'catastrophic', 'outrageous'
        ]);
    }

    analyze(text) {
        const words = text.toLowerCase().split(/\s+/);
        
        // Calculate bias score
        let biasScore = 50;
        words.forEach(word => {
            if (this.biasTerms.left.has(word)) biasScore -= 2;
            if (this.biasTerms.right.has(word)) biasScore += 2;
        });
        biasScore = Math.max(0, Math.min(100, biasScore));

        // Calculate emotional content using word matching instead of sentiment library
        const emotionalWords = new Set([
            'angry', 'happy', 'sad', 'furious', 'delighted', 'outraged',
            'excited', 'terrible', 'wonderful', 'horrible', 'amazing', 'awful'
        ]);
        
        const emotionalCount = words.filter(word => emotionalWords.has(word)).length;
        const emotionalScore = Math.min(100, (emotionalCount / words.length) * 1000);

        // Find loaded terms
        const loadedTerms = words.filter(word => this.loadedLanguage.has(word));

        // Extract key topics (simple frequency analysis)
        const topicFrequency = new Map();
        const stopWords = new Set(['the', 'a', 'an', 'and', 'or', 'but', 'in', 'on', 'at', 'to', 'for', 'of', 'with', 'by']);
        
        words.forEach(word => {
            if (!stopWords.has(word) && word.length > 3) {
                topicFrequency.set(word, (topicFrequency.get(word) || 0) + 1);
            }
        });

        const topics = Array.from(topicFrequency.entries())
            .sort((a, b) => b[1] - a[1])
            .slice(0, 5)
            .map(([text, count]) => ({ text, count }));

        // Create annotated text
        const annotated = this.annotateText(text);

        return {
            bias: {
                score: biasScore,
                label: this.getBiasLabel(biasScore)
            },
            emotional: {
                score: emotionalScore,
                label: this.getEmotionalLabel(emotionalScore)
            },
            loaded: loadedTerms,
            topics: topics,
            annotated: annotated
        };
    }

    annotateText(text) {
        const words = text.split(/\b/);
        return words.map(word => {
            const lower = word.toLowerCase();
            if (this.biasTerms.left.has(lower)) {
                return `<span class="highlight text-primary">${word}</span>`;
            }
            if (this.biasTerms.right.has(lower)) {
                return `<span class="highlight text-danger">${word}</span>`;
            }
            if (this.loadedLanguage.has(lower)) {
                return `<span class="highlight text-warning">${word}</span>`;
            }
            return word;
        }).join('');
    }

    getBiasLabel(score) {
        if (score < 40) return 'Strong Left Bias';
        if (score < 45) return 'Moderate Left Bias';
        if (score <= 55) return 'Relatively Neutral';
        if (score <= 60) return 'Moderate Right Bias';
        return 'Strong Right Bias';
    }

    getEmotionalLabel(score) {
        if (score < 40) return 'Very Neutral';
        if (score < 60) return 'Moderately Emotional';
        return 'Highly Emotional';
    }
}

        // Initialize analyzer and add event listeners
        document.addEventListener('DOMContentLoaded', () => {
            const analyzer = new BiasAnalyzer();
            const analyzeBtn = document.getElementById('analyzeBtn');
            const results = document.getElementById('results');

            analyzeBtn.addEventListener('click', () => {
                const text = document.getElementById('textInput').value.trim();
                if (!text) {
                    alert('Please enter some text to analyze');
                    return;
                }

                const analysis = analyzer.analyze(text);
                updateUI(analysis);
                results.classList.remove('d-none');
            });

            function updateUI(analysis) {
                // Update bias meter
                document.getElementById('biasMeter').style.width = `${analysis.bias.score}%`;
                document.getElementById('biasScore').textContent = analysis.bias.label;

                // Update emotional meter
                document.getElementById('emotionalMeter').style.width = `${analysis.emotional.score}%`;
                document.getElementById('emotionalScore').textContent = analysis.emotional.label;

                // Update loaded terms
                document.getElementById('loadedTerms').innerHTML = analysis.loaded
                    .map(term => `<span class="tag">${term}</span>`)
                    .join('');

                // Update key topics
                document.getElementById('keyTopics').innerHTML = analysis.topics
                    .map(topic => `<span class="tag">${topic.text} (${topic.count})</span>`)
                    .join('');

                // Update annotated text
                document.getElementById('annotatedText').innerHTML = analysis.annotated;
            }
        });
    </script>
</body>
</html>
