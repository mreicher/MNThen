<!DOCTYPE html>
<html lang="en">
<head>
  
      <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0M8KR45LDB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0M8KR45LDB');
</script>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="Minnesota, history, walking tours, interactive, landmarks, neighborhoods">
  <title>Minnesota Then | Blpg</title>
<link rel="shortcut icon" type="image/x-icon" href="https://www.mnthen.com/images/mnthenfav.ico">

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <link rel="stylesheet" href="https://www.mnthen.com/css/footer.css">
  <link rel="stylesheet" href="https://www.mnthen.com/css/new_index_page.css">
  <link rel="stylesheet" href="https://www.mnthen.com/css/new_header.css">
  <link rel="stylesheet" href="https://www.mnthen.com/css/navbar.css">
          
   
    <style>

    </style>
</head>
<body>

<!-- Today in Minnesota History Section -->
<div class="today-in-history" style="background-color: #E6ECF5; padding: 40px 0;">
    <div class="container-fluid">
        <div class="row justify-content-center">
            <div class="col-md-4">
                <img src="/images/otd_blog.png" alt="Historical Image" class="img-fluid">
            </div>
            <div class="col-md-8">
                <h2 class="section-title">Today in Minnesota History</h2>
                <div id="today-date"></div>
                <div id="today-in-history-content">
                    <!-- Content will be loaded dynamically from Firebase -->
                </div>
            </div>
        </div>
    </div>
</div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

<!-- Firebase Integration (You'll need to set up Firebase and include the necessary scripts) -->
<script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-database.js"></script>

<script>
const dropdownToggle = document.querySelector('.dropdown-toggle');
const dropdownMenu = document.querySelector('.dropdown-menu');

dropdownToggle.addEventListener('click', function() {
  dropdownMenu.classList.toggle('show');
});

// Add event listener to the entire document
document.addEventListener('click', function(event) {
  // Check if the clicked element is not the dropdown toggle or a child of the dropdown menu
  if (!event.target.matches('.dropdown-toggle') && !event.target.closest('.dropdown-menu')) {
    // If not, close the dropdown menu
    dropdownMenu.classList.remove('show');
  }
});

const toggleButton = document.querySelector('.toggle-button');
const navbarLinks = document.querySelector('.navbar-links');

toggleButton.addEventListener('click', () => {
  navbarLinks.classList.toggle('active');
});

document.addEventListener('click', (event) => {
  const isClickInsideNavbarLinks = navbarLinks.contains(event.target);
  const isClickInsideToggleButton = toggleButton.contains(event.target);

  if (!isClickInsideNavbarLinks && !isClickInsideToggleButton && navbarLinks.classList.contains('active')) {
    navbarLinks.classList.remove('active');
  }
});

  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyBDUAF3qJGhLYQJPHyWwY0JzonN5l8ERzE",
    authDomain: "mnthen-3151d.firebaseapp.com",
    projectId: "mnthen-3151d",
    storageBucket: "mnthen-3151d.appspot.com",
    messagingSenderId: "416231360428",
    appId: "1:416231360428:web:36f69cc231be2d84a8dc09"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const database = firebase.database();
  const auth = firebase.auth();

  // Check if user is authenticated
  firebase.auth().onAuthStateChanged((user) => {
    const accountLink = document.getElementById('account-link');
    if (user) {
      // User is logged in, update the link to point to the account page
      accountLink.href = 'account.html';
      accountLink.innerHTML = '<i class="fas fa-user-circle""></i><span> Account Info</span>';
    } else {
      // User is not logged in, revert the link back to Sign In | Register
      accountLink.href = 'login.html';
      accountLink.innerHTML = '<i class="fas fa-user" "></i><span> Log In <span>|</span> Register</span>';
    }
  });

  // Function to fetch historical events
  function getHistoricalEvents() {
    // Get current date in mm-dd format
    const today = new Date();
    const month = (today.getMonth() + 1).toString().padStart(2, '0');
    const date = today.getDate().toString().padStart(2, '0');
    const formattedDate = `${month}-${date}`;

    // Create a reference to historical events for the current date
    const historicalEventRef = database.ref('date-info/' + formattedDate);

    // Fetch data from Firebase
    historicalEventRef.once('value', (snapshot) => {
      // Callback function handling successful data retrieval
      const historicalEvents = snapshot.val();
      const contentDiv = document.getElementById('today-in-history-content');

      if (historicalEvents) {
        // Clear previous content
        contentDiv.innerHTML = '';

        // Sort events chronologically by key (assuming keys are timestamps or sequentially ordered)
        const sortedKeys = Object.keys(historicalEvents).sort();

        // Array to hold HTML strings
        const htmlStrings = [];

        // Iterate through each historical event and build HTML strings
        sortedKeys.forEach((key) => {
          const event = historicalEvents[key];
          htmlStrings.push(`<p><strong>${event.year}:</strong> ${event.snippet}</p>`);
        });

        // Join all HTML strings and set as innerHTML
        contentDiv.innerHTML = htmlStrings.join('');
      } else {
        // Handle the case when no historical events are found for the current date
        contentDiv.innerHTML = `<p>No historical events found for this date (${formattedDate}).</p>`;
      }
    }, (error) => {
      // Error callback function
      console.error('Error fetching historical events:', error);
      const contentDiv = document.getElementById('today-in-history-content');
      contentDiv.innerHTML = '<p>An error occurred while fetching data. Please try again later.</p>';
    });
  }

  // Call the function to fetch historical events after Firebase initialization
  getHistoricalEvents();

  // Carousel logic
document.addEventListener('DOMContentLoaded', function() {
    const carousel = document.querySelector('#mainCarousel');
    if (carousel) {
        const carouselInstance = new bootstrap.Carousel(carousel, {
            interval: 30000,
            wrap: true,
            touch: true
        });
    }
});
</script>

 <script>
        var today = new Date();
        var options = { month: 'long', day: 'numeric' };
        var formattedDate = today.toLocaleDateString('en-US', options);
        document.getElementById('today-date').textContent = formattedDate;
    </script>
    
<!-- Bootstrap JS (for modal functionality) -->
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
  
  
</body>
</html>
