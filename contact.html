<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Minnesota Then | Contact Form</title>
  <link rel="shortcut icon" type="image/jpg" href="/images/mnthenfav.ico" />

  <!-- Preconnect to external domains -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="preconnect" href="https://cdnjs.cloudflare.com">

  <!-- Bootstrap 5.3.2 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />

  <!-- Custom CSS  -->
  <link rel="stylesheet" href="https://www.mnthen.com/css/dropdown.css">
  <link rel="stylesheet" href="https://www.mnthen.com/css/mnthen_contact.css">
  <link rel="stylesheet" href="https://www.mnthen.com/css/mnthen_header.css">
  <link rel="stylesheet" href="https://www.mnthen.com/css/mnthen_footer.css"> 
    <link rel="stylesheet" href="https://www.mnthen.com/css/mnthen_article_fab.css"> 

<style>
/* Main Content Styling */
main {
  max-width: 1200px;
  margin: 0 auto;
  padding: 3rem 1.5rem;
  background-color: #E6EFF5; 
}

/* Form Container */
.form-container {
  background: #ffffff;
  border-radius: 16px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.0025);
  padding: 2.5rem;
  margin-bottom: 3rem;
  transition: transform 0.3s ease;
}

.contact-header {
  text-align: center;
  margin-bottom: 2.5rem;
}

.contact-header h2 {
  font-size: 2.2rem;
  color: var(--primary);
  margin-bottom: 1rem;
  font-weight: 700;
}

.contact-header p {
  color: var(--text-light);
  font-size: 1.1rem;
  max-width: 600px;
  margin: 0 auto;
}

/* Form Grid */
.form-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1.5rem;
  margin-bottom: 2rem;
}

.form-group {
  position: relative;
}

.form-group.full-width {
  grid-column: span 2;
}

label {
  display: block;
  margin-bottom: 0.5rem;
  font-weight: 600;
  color: var(--text);
  font-size: 0.95rem;
}

.input-with-icon {
  position: relative;
}

.input-with-icon i {
  position: absolute;
  left: 1rem;
  top: 50%;
  transform: translateY(-50%);
  color: var(--text-light);
  opacity: 0.7;
  transition: all 0.3s ease;
}

.textarea-container i {
  top: 1.5rem;
}

.form-control {
  width: 100%;
  padding: 0.8rem 1rem 0.8rem 2.5rem;
  border: 2px solid rgba(0, 0, 0, 0.08);
  border-radius: 10px;
  font-size: 1rem;
  transition: all 0.3s ease;
  background-color: rgba(0, 0, 0, 0.02);
}

textarea.form-control {
  min-height: 120px;
  resize: vertical;
}

.form-control:focus {
  outline: none;
  border-color: var(--accent);
  background-color: #fff;
  box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.025);
}

.form-control:focus + i,
.input-with-icon:hover i {
  color: var(--accent);
  opacity: 1;
}

.character-counter {
  text-align: right;
  margin-top: 0.5rem;
  font-size: 0.85rem;
  color: var(--text-light);
}

.word-counter {
  text-align: left;
  margin-top: 0.5rem;
  font-size: 0.85rem;
  color: var(--text-light);
}

.validation-message {
  margin-top: 0.5rem;
  font-size: 0.85rem;
  padding: 0.5rem;
  border-radius: 6px;
  display: none;
}

.validation-message.error {
  background-color: rgba(239, 68, 68, 0.1);
  color: #dc2626;
  border: 1px solid rgba(239, 68, 68, 0.2);
}

.validation-message.success {
  background-color: rgba(16, 185, 129, 0.1);
  color: #059669;
  border: 1px solid rgba(16, 185, 129, 0.2);
}

/* Verification Box */
.verification-box {
  background-color: rgba(0, 0, 0, 0.02);
  border-radius: 12px;
  padding: 1.5rem;
  margin-bottom: 2rem;
  border: 2px solid rgba(0, 0, 0, 0.04);
  transition: all 0.3s ease;
}

.verification-box:hover {
  background-color: rgba(0, 0, 0, 0.03);
}

.verification-header {
  display: flex;
  align-items: center;
  margin-bottom: 1.2rem;
  gap: 0.8rem;
}

.verification-icon {
  font-size: 1.5rem;
  color: var(--accent);
}

.verification-header h3 {
  margin: 0;
  font-size: 1.2rem;
  font-weight: 600;
  color: var(--text);
}

.verification-content {
  display: grid;
  gap: 1rem;
}

.math-challenge {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.math-challenge input {
  max-width: 200px;
  padding: 0.7rem 1rem;
  border: 2px solid rgba(0, 0, 0, 0.08);
  border-radius: 8px;
  font-size: 1rem;
}

.checkbox-label {
  display: flex;
  align-items: center;
  cursor: pointer;
  gap: 0.5rem;
}

.checkbox-label input[type="checkbox"] {
  width: 18px;
  height: 18px;
  cursor: pointer;
}

.checkbox-text {
  font-size: 0.95rem;
  color: var(--text);
}

.data-policy a {
  color: var(--accent);
  text-decoration: none;
  font-weight: 500;
}

.data-policy a:hover {
  text-decoration: underline;
}

/* Submit Button */
.submit-button {
  text-align: center;
}

.btn-submit {
  background-color: #0a2463; 
  color: white;
  border: none;
  padding: 0.9rem 2rem;
  font-size: 1.1rem;
  border-radius: 50px;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  font-weight: 600;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(10, 36, 99, 0.15);
}

.btn-submit:enabled:hover {
  background-color: #051d56; 
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(10, 36, 99, 0.25);
}

.btn-submit:enabled:active {
  transform: translateY(0);
}

.btn-submit:disabled {
  background-color: #aaa;
  cursor: not-allowed;
  box-shadow: none;
}

.btn-submit i {
  font-size: 1rem;
}

.submission-status {
  margin-top: 1rem;
  font-weight: 500;
  min-height: 24px;
}

.submission-status.success {
  color: #10b981;
}

.submission-status.error {
  color: #ef4444;
}

/* Contact Info Section */
.contact-info-section {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1.5rem;
  margin-top: 3rem;
}

.contact-card {
  background: #ffffff;
  border-radius: 12px;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.025);
  padding: 2rem;
  text-align: center;
  transition: all 0.3s ease;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.contact-icon {
  width: 60px;
  height: 60px;
  background-color: rgba(59, 130, 246, 0.1);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 1.2rem;
}

.contact-icon i {
  font-size: 1.5rem;
  color: var(--accent);
}

.contact-card h3 {
  font-size: 1.25rem;
  font-weight: 600;
  margin-bottom: 0.8rem;
  color: var(--text);
}

.contact-card p {
  color: var(--text-light);
  margin-bottom: 1.5rem;
  font-size: 0.95rem;
  flex-grow: 1;
}

.contact-link {
  display: inline-block;
  color: var(--accent);
  font-weight: 600;
  text-decoration: none;
  padding: 0.5rem 0;
  position: relative;
  transition: all 0.3s ease;
}

.contact-link:after {
  content: '';
  position: absolute;
  width: 0;
  height: 2px;
  bottom: 0;
  left: 0;
  background-color: var(--accent);
  transition: width 0.3s ease;
}

.contact-link:hover:after {
  width: 100%;
}

/* Contact Card Icons - Different colors for each card */
.contact-card:nth-child(1) .contact-icon {
  background-color: rgba(220, 68, 5, 0.1); /* Red tint background */
}

.contact-card:nth-child(1) .contact-icon i {
  color: #dc4405; /* Red */
}

.contact-card:nth-child(2) .contact-icon {
  background-color: rgba(76, 175, 80, 0.1); /* Green tint background */
}

.contact-card:nth-child(2) .contact-icon i {
  color: #4caf50; /* Green */
}

.contact-card:nth-child(3) .contact-icon {
  background-color: rgba(156, 39, 176, 0.1); /* Purple tint background */
}

.contact-card:nth-child(3) .contact-icon i {
  color: #9c27b0; /* Purple */
}

/* Responsive adjustments */
@media (max-width: 992px) {
  .contact-info-section {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 768px) {
  .form-grid {
    grid-template-columns: 1fr;
  }
  
  .form-group.full-width {
    grid-column: 1;
  }
  
  .contact-info-section {
    grid-template-columns: 1fr;
  }
  
  .form-container {
    padding: 1.5rem;
  }
}
</style>
  
</head>

<body>
  <!-- Header -->
<header class="mnthen-header">
  <div class="mnthen-header-container">
    <a href="/" class="mnthen-logo">
      <img src="https://www.mnthen.com/images/logo.webp" alt="Minnesota Then Logo" class="mnthen-logo-img" /> 
      Minnesota Then
    </a>
    
    <button class="mnthen-mobile-menu" aria-label="Toggle menu">
      <span></span>
      <span></span>
      <span></span>
    </button>
    
    <nav class="mnthen-nav">
      <ul class="mnthen-nav-list">
        <li class="mnthen-nav-item">
          <button class="mnthen-dropdown-btn">
            About
            <svg class="mnthen-dropdown-arrow" viewBox="0 0 24 24" width="16" height="16">
              <path d="M7 10l5 5 5-5z"/>
            </svg>
          </button>
          <div class="mnthen-dropdown-content">
            <a href="https://mnthen.com/mission.html">Mission</a>
            <a href="https://mnthen.com/ourteam.html">Our Team</a>
            <a href="https://mnthen.com/contact">Contact</a>
          </div>
        </li>
        <li class="mnthen-nav-item">
          <button class="mnthen-dropdown-btn">
            Multimedia
            <svg class="mnthen-dropdown-arrow" viewBox="0 0 24 24" width="16" height="16">
              <path d="M7 10l5 5 5-5z"/>
            </svg>
          </button>
          <div class="mnthen-dropdown-content">
            <a href="https://mnthen.com/blog.html">Blog</a>
            <a href="https://www.youtube.com/@mnthen" target="_blank">YouTube</a>
            <a href="https://mnthen.com/podcast.html">Podcast</a>
          </div>
        </li>
        <li class="mnthen-nav-item">
          <button class="mnthen-dropdown-btn">
            Resources
            <svg class="mnthen-dropdown-arrow" viewBox="0 0 24 24" width="16" height="16">
              <path d="M7 10l5 5 5-5z"/>
            </svg>
          </button>
          <div class="mnthen-dropdown-content">
            <a href="https://mnthen.com/faq.html">Help Center</a>
            <a href="https://mnthen.com/upcoming_events.html">Upcoming Events</a>
            <a href="https://mnthen.com/resources.html">Research Tools</a>
          </div>
        </li>
        <li class="mnthen-nav-item">
          <button class="mnthen-dropdown-btn">
            Interact
            <svg class="mnthen-dropdown-arrow" viewBox="0 0 24 24" width="16" height="16">
              <path d="M7 10l5 5 5-5z"/>
            </svg>
          </button>
          <div class="mnthen-dropdown-content">
            <a href="https://www.patreon.com/mnthen" target="_blank">Join Our Patreon</a>
            <a href="https://mnthen.com/markers.html">Share Your Story</a>
            <a href="https://mnthen.com/trivia.html">Play Trivia Games</a> 
          </div>
        </li>
        <li class="mnthen-nav-item">
          <a href="https://mnthen.com/donate.html" class="mnthen-donate-btn">Donate</a>
        </li>
      </ul>
    </nav>
  </div>
</header>

  <!-- Hero Section -->
  <section class="hero-section" style="margin-top: 80px">
    <div class="hero-content">
      <h1>Let's Start a Conversation</h1>
      <p class="hero-subtitle">Share your thoughts with us. We're here to answer any questions you might have.</p>
    </div>
  </section>

<!-- Main Content -->
<main>
  <div class="form-container" style="margin-top: 50px">
    <div class="contact-header">
      <h2>Contact Us</h2>
      <p>We'd love to hear from you! Please provide a subject and write at least 10 words in your message to help us better understand your inquiry.</p>
    </div>

    <form id="contact-form" action="https://formsubmit.co/0129751df5a8d0468e1ff55212dd00c3" method="POST">
      <input type="hidden" name="_captcha" value="false">
      <input type="text" name="_honey" style="display:none">
      <input type="hidden" id="form-timestamp" name="form-timestamp">
      <input type="hidden" name="_subject" value="New Minnesota Then Contact Form Submission">

      <div class="form-grid">
        <div class="form-group">
          <label for="name">Full Name</label>
          <div class="input-with-icon">
            <i class="fas fa-user"></i>
            <input type="text" id="name" name="name" class="form-control" required autocomplete="name">
          </div>
        </div>

        <div class="form-group">
          <label for="email">Email Address</label>
          <div class="input-with-icon">
            <i class="fas fa-envelope"></i>
            <input type="email" id="email" name="email" class="form-control" required autocomplete="email">
          </div>
        </div>

        <div class="form-group full-width">
          <label for="subject">Subject <span style="color: #dc2626;">*</span></label>
          <div class="input-with-icon">
            <i class="fas fa-heading"></i>
            <select id="subject" name="subject" class="form-control" required>
              <option value="" disabled selected>Please select a topic for your message</option>
              <option value="General Inquiry">General Inquiry</option>
              <option value="Research Request">Research Request</option>
              <option value="Collaboration">Collaboration Opportunity</option>
              <option value="Feedback">Feedback</option>
              <option value="Technical Support">Technical Support</option>
              <option value="Media Inquiry">Media Inquiry</option>
              <option value="Partnership">Partnership Opportunity</option>
            </select>
          </div>
          <div class="validation-message" id="subject-validation">
            <i class="fas fa-exclamation-triangle"></i> Please select a subject for your message.
          </div>
        </div>

        <div class="form-group full-width">
          <label for="message">Your Message <span style="color: #dc2626;">*</span></label>
          <div class="input-with-icon textarea-container">
            <i class="fas fa-comment-alt"></i>
            <textarea id="message" name="message" class="form-control" required rows="10" placeholder="Please write at least 10 words to help us understand your inquiry better..."></textarea>
          </div>
          <div style="display: flex; justify-content: space-between; align-items: center;">
            <div class="word-counter">
              <span id="word-count">0</span> words (minimum 10 required)
            </div>
            <div class="character-counter">
              <span id="char-count">0</span>/1000 characters
            </div>
          </div>
          <div class="validation-message" id="message-validation">
            <i class="fas fa-exclamation-triangle"></i> Please write at least 5 words in your message.
          </div>
        </div>
      </div>

      <!-- Human Verification -->
      <div class="verification-box">
        <div class="verification-header">
          <i class="fas fa-shield-alt verification-icon"></i>
          <h3>Security Verification</h3>
        </div>
        <div class="verification-content">
          <div id="dynamic-challenge" class="math-challenge">
            <!-- Dynamic challenge will be inserted here by JavaScript -->
          </div>
          <div class="checkbox-confirm">
            <label class="checkbox-label">
              <input type="checkbox" id="confirm-human" name="confirm-human" required>
              <span class="checkbox-text">I confirm I'm not a robot and have provided meaningful content</span>
            </label>
          </div>
          <div class="data-policy">
            <label class="checkbox-label">
              <input type="checkbox" id="data-policy" name="data-policy" required>
              <span class="checkbox-text">I understand that my data will be processed according to Minnesota Then's <a href="/privacy_terms.html" target="_blank">Privacy Policy</a></span>
            </label>
          </div>
        </div>
      </div>

      <div class="submit-button">
        <button type="submit" id="submit-btn" class="btn-submit" disabled>
          <i class="fas fa-paper-plane"></i>
          Send Message
        </button>
        <div class="submission-status" id="submission-status"></div>
      </div>
    </form>
  </div>

  <div class="contact-info-section">
    <div class="contact-card">
      <div class="contact-icon">
        <i class="fas fa-question-circle"></i>
      </div>
      <h3>Need Quick Answers?</h3>
      <p>Check our Help Center for immediate answers to common questions.</p>
      <a href="https://www.mnthen.com/faq.html" class="contact-link">Visit the Help Center</a>
    </div>
    
    <div class="contact-card">
      <div class="contact-icon">
        <i class="fas fa-calendar-alt"></i>
      </div>
      <h3>Upcoming Events</h3>
      <p>Join us for our next history talk or community event.</p>
      <a href="https://mnthen.com/upcoming_events.html" class="contact-link">View Events Calendar</a>
    </div>
    
    <div class="contact-card">
      <div class="contact-icon">
        <i class="fas fa-podcast"></i>
      </div>
      <h3>Listen & Learn</h3>
      <p>Discover Minnesota's rich history through our podcast.</p>
      <a href="https://mnthen.com/podcast.html" class="contact-link">Explore Podcast Episodes</a>
    </div>
  </div>
</main>

            <!-- Floating Action Button (FAB) to return to the front page -->
    <a href="https://www.mnthen.com/index.html" class="mnthen-fab" aria-label="Return to Front Page">
        <i class="fas fa-home"></i>
        <span class="mnthen-fab-tooltip">Back to the Home Page</span>
    </a>

<!-- Footer -->
<footer class="footer bg-primary py-5"> 
<div class="container">
  <div class="row g-4 mb-4">
      <div class="col-lg-3 col-md-6 pt-3">
          <h3 class="footer-brand mb-3">
              <span class="text-white">Minnesota</span>
              <span class="text-navy">Then</span>
          </h3>
      </div>
      <div class="col-lg-2 col-md-6">
          <h5 class="text-white mb-3">Who We Are</h5>
          <ul class="list-unstyled footer-links">
              <li><a href="/about.html">About Us</a></li>
              <li><a href="/privacy_terms.html">ToS & Privacy</a></li>
          </ul>
      </div>
      <div class="col-lg-2 col-md-6">
          <h5 class="text-white mb-3">What We Do</h5>
          <ul class="list-unstyled footer-links">
              <li><a href="https://mnthen.com/blog.html">Blog</a></li>
              <li><a href="https://www.mnthen.com/article/thesis_project.pdf">Thesis Project</a></li>
              <li><a href="/upcoming_events.html">Upcoming Events</a></li>
          </ul>
      </div>
      <div class="col-lg-2 col-md-6">
          <h5 class="text-white mb-3">Resources</h5>
          <ul class="list-unstyled footer-links">
              <a href="https://github.com/mreicher/MNThen/" target="_blank" rel="noopener noreferrer">GitHub</a>
              <li><a href="/faq.html">Help Center</a></li>
              <li><a href="/resources.html">Research Tools</a></li>
          </ul>
      </div>
      <div class="col-lg-3 col-md-6 pt-3">
          <p class="tagline">Every Step Tells a Story</p>
      </div>
  </div>
  <hr class="footer-divider">
  <div class="row align-items-center">
<div class="col-md-4 text-center text-md-start">
<small style="color: white;">&copy; 2025 Minnesota Then. All rights reserved</small>
</div>
       <div class="col-md-8">
           <div class="social-icons text-center text-md-end">
               <span class="me-2" style="color: white;">Connect:</span>
               <a href="https://www.facebook.com/profile.php?id=100090355652945" target="_blank" class="text-white" rel="noreferrer">
                   <i class="fab fa-facebook-f"></i>
               </a>
               <span class="mx-2 text-white">|</span>
               <a href="https://bsky.app/profile/mnthen.bsky.social" target="_blank" class="text-white" rel="noreferrer">
                   <i class="fa-brands fa-bluesky"></i>
               </a>
               <span class="mx-2 text-white">|</span>
               <a href="https://www.linkedin.com/company/minnesota-then" target="_blank" class="text-white" rel="noreferrer">
                   <i class="fab fa-linkedin-in"></i>
               </a>
           </div>
       </div>
  </div>
</div>
</footer>

  <!-- Thank You Modal -->
  <div class="modal fade" id="thankYouModal" tabindex="-1" aria-labelledby="thankYouModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="thankYouModalLabel">Thank You!</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>Your message has been successfully sent. We'll get back to you as soon as possible.</p>
        </div>
        <div class="modal-footer">
          <a href="/" class="btn btn-primary">Return to Home</a>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Initialize Navigation (Dropdown and Mobile Menu)
    function initializeNavigation() {
      const mobileMenuBtn = document.querySelector('.mnthen-mobile-menu');
      const mainNav = document.querySelector('.mnthen-nav');
      const dropdownBtns = document.querySelectorAll('.mnthen-dropdown-btn');

      // Mobile Menu Toggle
      if (mobileMenuBtn && mainNav) {
        mobileMenuBtn.addEventListener('click', function (e) {
          e.stopPropagation();
          this.classList.toggle('active');
          mainNav.classList.toggle('active');
        });
      }

      // Dropdown Toggle
      dropdownBtns.forEach(btn => {
        btn.addEventListener('click', function (e) {
          e.stopPropagation();
          const dropdownContent = this.nextElementSibling;

          // Close other dropdowns
          dropdownBtns.forEach(otherBtn => {
            if (otherBtn !== btn) {
              otherBtn.nextElementSibling.classList.remove('active');
            }
          });

          // Toggle current dropdown
          dropdownContent.classList.toggle('active');
        });
      });

      // Close dropdowns and mobile menu when clicking outside
      document.addEventListener('click', function (e) {
        if (!e.target.closest('.mnthen-nav') && !e.target.closest('.mnthen-mobile-menu')) {
          mainNav?.classList.remove('active');
          mobileMenuBtn?.classList.remove('active');

          dropdownBtns.forEach(btn => {
            btn.nextElementSibling.classList.remove('active');
          });
        }
      });

      // Handle window resize
      window.addEventListener('resize', function () {
        if (window.innerWidth > 768) {
          mainNav?.classList.remove('active');
          mobileMenuBtn?.classList.remove('active');

          dropdownBtns.forEach(btn => {
            btn.nextElementSibling.classList.remove('active');
          });
        }
      });
    }

    // Enhanced Contact Form with Security Features
    function initializeContactForm() {
      const contactForm = document.getElementById('contact-form');
      const timestampField = document.getElementById('form-timestamp');
      const messageField = document.getElementById('message');
      const subjectField = document.getElementById('subject');
      const charCounter = document.getElementById('char-count');
      const wordCounter = document.getElementById('word-count');
      const submitBtn = document.getElementById('submit-btn');
      const confirmHuman = document.getElementById('confirm-human');
      const dataPolicy = document.getElementById('data-policy');
      const submissionStatus = document.getElementById('submission-status');
      const dynamicChallenge = document.getElementById('dynamic-challenge');
      const subjectValidation = document.getElementById('subject-validation');
      const messageValidation = document.getElementById('message-validation');

      // Set initial timestamp
      if (timestampField) {
        timestampField.value = Date.now().toString();
      }

      // Generate random math challenge
      function generateMathChallenge() {
        const operations = [
          { symbol: '+', func: (a, b) => a + b },
          { symbol: '-', func: (a, b) => a - b },
          { symbol: '×', func: (a, b) => a * b }
        ];

        let num1, num2, operation;

        // Generate appropriate numbers based on operation
        const opIndex = Math.floor(Math.random() * operations.length);
        operation = operations[opIndex];

        if (operation.symbol === '+') {
          num1 = Math.floor(Math.random() * 10) + 1;
          num2 = Math.floor(Math.random() * 10) + 1;
        } else if (operation.symbol === '-') {
          num1 = Math.floor(Math.random() * 10) + 10;
          num2 = Math.floor(Math.random() * num1) + 1;
        } else { // multiplication
          num1 = Math.floor(Math.random() * 5) + 1;
          num2 = Math.floor(Math.random() * 5) + 1;
        }

        const answer = operation.func(num1, num2);

        // Create challenge HTML
        const challengeHTML = `
          <label for="math-answer">Security Question: What is ${num1} ${operation.symbol} ${num2}?</label>
          <input type="text" id="math-answer" name="math-answer" required placeholder="Enter your answer">
          <input type="hidden" id="math-expected" value="${answer}">
        `;

        return challengeHTML;
      }

      // Set up dynamic challenge
      if (dynamicChallenge) {
        dynamicChallenge.innerHTML = generateMathChallenge();
      }

      // Word and character counter for message
      if (messageField && charCounter && wordCounter) {
        messageField.setAttribute('maxlength', '1000');

        messageField.addEventListener('input', function () {
          const text = this.value.trim();
          const length = this.value.length;
          const words = text === '' ? 0 : text.split(/\s+/).length;

          // Update counters
          charCounter.textContent = length;
          wordCounter.textContent = words;

          // Character counter color
          if (length > 950) {
            charCounter.style.color = '#ef4444';
          } else if (length > 800) {
            charCounter.style.color = '#f59e0b';
          } else {
            charCounter.style.color = 'var(--text-light)';
          }

          // Word counter color and validation
          if (words < 5) {
            wordCounter.style.color = '#ef4444';
            messageValidation.style.display = 'block';
            messageValidation.className = 'validation-message error';
          } else {
            wordCounter.style.color = '#059669';
            messageValidation.style.display = 'none';
          }

          updateSubmitButton();
        });
      }

      // Subject validation
      if (subjectField) {
        subjectField.addEventListener('change', function () {
          if (this.value === '') {
            subjectValidation.style.display = 'block';
            subjectValidation.className = 'validation-message error';
          } else {
            subjectValidation.style.display = 'none';
          }
          updateSubmitButton();
        });
      }

      // Form validation
      function validateForm() {
        const mathAnswer = document.getElementById('math-answer')?.value;
        const mathExpected = document.getElementById('math-expected')?.value;
        const email = document.getElementById('email')?.value;
        const subject = subjectField?.value;
        const message = messageField?.value.trim();

        if (!mathAnswer || !mathExpected || !email || !subject || !message) return false;

        // Validate math challenge
        if (mathAnswer !== mathExpected) return false;

        // Validate email format
        const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailPattern.test(email)) return false;

        // Validate subject is selected
        if (subject === '') return false;

        // Validate message has at least 5 words
        const words = message === '' ? 0 : message.split(/\s+/).length;
        if (words < 5) return false;

        return true;
      }

      // Enable/disable submit button based on validation
      function updateSubmitButton() {
        if (confirmHuman && dataPolicy && submitBtn) {
          const isValid = confirmHuman.checked && dataPolicy.checked && validateForm();
          submitBtn.disabled = !isValid;
          
          if (isValid) {
            submitBtn.style.backgroundColor = '#0a2463';
          } else {
            submitBtn.style.backgroundColor = '#aaa';
          }
        }
      }

      // Input validation events
      document.querySelectorAll('#contact-form input, #contact-form textarea, #contact-form select').forEach(el => {
        el.addEventListener('input', updateSubmitButton);
        el.addEventListener('change', updateSubmitButton);
      });

      // Checkbox change events
      if (confirmHuman) {
        confirmHuman.addEventListener('change', updateSubmitButton);
      }

      if (dataPolicy) {
        dataPolicy.addEventListener('change', updateSubmitButton);
      }

      // Form submission
      if (contactForm) {
        contactForm.addEventListener('submit', async function (e) {
          e.preventDefault();

          // Time verification
          const submissionTime = Date.now();
          const formLoadTime = parseInt(timestampField.value);
          const timeDifference = submissionTime - formLoadTime;

          // Safety checks
          if (timeDifference < 5000) {
            submissionStatus.textContent = 'Please take your time to fill out the form properly.';
            submissionStatus.className = 'submission-status error';
            return;
          }

          if (timeDifference > 1800000) { // 30 minutes
            submissionStatus.textContent = 'This form has expired. Please refresh the page and try again.';
            submissionStatus.className = 'submission-status error';
            return;
          }

          // Double check validation
          if (!validateForm()) {
            submissionStatus.textContent = 'Please complete all required fields correctly, including selecting a subject and writing at least 5 words in your message.';
            submissionStatus.className = 'submission-status error';
            return;
          }

          // Additional bot detection - check for meaningful content
          const message = messageField.value.trim();
          const words = message.split(/\s+/);
          
          // Check for repetitive content (basic bot detection)
          const uniqueWords = new Set(words.map(word => word.toLowerCase()));
          if (words.length >= 5 && uniqueWords.size < 3) {
            submissionStatus.textContent = 'Please provide a more detailed and meaningful message.';
            submissionStatus.className = 'submission-status error';
            return;
          }

          // Disable button during submission to prevent multiple submissions
          submitBtn.disabled = true;
          submitBtn.innerHTML = '<i class="fas fa-circle-notch fa-spin"></i> Sending...';

          // Submit the form data using fetch
          try {
            const formData = new FormData(contactForm);
            const response = await fetch(contactForm.action, {
              method: 'POST',
              body: formData,
              headers: {
                'Accept': 'application/json'
              }
            });

            if (response.ok) {
              // Show the thank you modal
              const thankYouModal = new bootstrap.Modal(document.getElementById('thankYouModal'));
              thankYouModal.show();

              // Reset the form
              contactForm.reset();
              
              // Reset counters
              if (charCounter) charCounter.textContent = '0';
              if (wordCounter) wordCounter.textContent = '0';
              
              // Hide validation messages
              if (subjectValidation) subjectValidation.style.display = 'none';
              if (messageValidation) messageValidation.style.display = 'none';
              
              // Generate new math challenge
              if (dynamicChallenge) {
                dynamicChallenge.innerHTML = generateMathChallenge();
              }
              
              // Reset timestamp
              if (timestampField) {
                timestampField.value = Date.now().toString();
              }
            } else {
              submissionStatus.textContent = 'There was an error submitting the form. Please try again.';
              submissionStatus.className = 'submission-status error';
            }
          } catch (error) {
            submissionStatus.textContent = 'There was an error submitting the form. Please try again.';
            submissionStatus.className = 'submission-status error';
          } finally {
            submitBtn.disabled = false;
            submitBtn.innerHTML = '<i class="fas fa-paper-plane"></i> Send Message';
            updateSubmitButton(); // Re-validate form state
          }
        });
      }
    }

    // Initialize navigation and contact form
    document.addEventListener('DOMContentLoaded', function () {
      initializeNavigation();
      initializeContactForm();
    });
  </script>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</body>
</html>
