<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-0M8KR45LDB"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-0M8KR45LDB');
  </script>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Minnesota Then | History Trivia</title>
  <link rel="shortcut icon" type="image/x-icon" href="https://www.mnthen.com/images/mnthenfav.ico">

  <!-- External Stylesheets -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  
  <!-- Custom Styles -->
  <link rel="stylesheet" href="https://www.mnthen.com/css/dropdown.css">
  <link rel="stylesheet" href="https://www.mnthen.com/css/mnthen_header.css">
  <link rel="stylesheet" href="https://www.mnthen.com/css/mnthen_footer.css">
  <link rel="stylesheet" href="https://www.mnthen.com/css/mnthen_article_fab.css">
  
  <style>
    :root {
      --primary-color: #0e3b7d;
      --secondary-color: #d4a017;
      --accent-color: #e63946;
      --light-bg: #f8f9fa;
      --dark-bg: #212529;
      --text-color: #333;
      --light-text: #f8f9fa;
    }
    
    /* Hero Section */
    .hero-section {
      margin-top: 80px;
      background-color: var(--primary-color);
      padding: 4rem 0;
      text-align: center;
      color: white;
    }
    
    .hero-content h1 {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 1rem;
    }
    
    .hero-subtitle {
      font-size: 1.2rem;
      max-width: 700px;
      margin: 0 auto;
    }
    
    /* Search Section */
    .search-section {
      padding: 2rem 0;
      background-color: var(--light-bg);
    }
    
    .search-container {
      max-width: 800px;
      margin: 0 auto;
      position: relative;
    }
    
    .search-input {
      width: 100%;
      padding: 0.75rem 1.5rem;
      border: 1px solid #ddd;
      border-radius: 30px;
      font-size: 1rem;
      padding-right: 50px;
    }
    
    .search-button {
      position: absolute;
      right: 5px;
      top: 5px;
      background: var(--primary-color);
      color: white;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color 0.2s ease;
    }
    
    .search-button:hover {
      background-color: #0a2e62;
    }
    
    /* Game Cards */
    .game-card {
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      overflow: hidden;
      height: 100%;
      background-color: white;
      transition: box-shadow 0.2s ease;
    }
    
    .game-card:hover {
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    
    .game-card-img-container {
      position: relative;
      width: 100%;
      height: 280px;
      overflow: hidden;
    }
    
    .game-card-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .game-card-body {
      padding: 1.5rem;
    }
    
    .game-card-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 0.75rem;
    }
    
    .game-card-text {
      color: #555;
      margin-bottom: 1.25rem;
    }
    
    .game-card-footer {
      padding: 0 1.5rem 1.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .game-card-stats {
      font-size: 0.9rem;
      color: #6c757d;
    }
    
    .game-card-btn {
      background-color: var(--primary-color);
      color: white;
      border: none;
      border-radius: 30px;
      padding: 0.5rem 1.5rem;
      font-weight: 500;
      transition: background-color 0.2s ease;
    }
    
    .game-card-btn:hover {
      background-color: #0a2e62;
      color: white;
    }
    
    /* Small Game Cards */
    .small-game-card {
      display: flex;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      overflow: hidden;
      background-color: white;
      margin-bottom: 1rem;
      transition: box-shadow 0.2s ease;
    }
    
    .small-game-card:hover {
      box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    }
    
    .small-game-card-img-container {
      width: 120px;
      height: 120px;
      flex-shrink: 0;
      overflow: hidden;
    }
    
    .small-game-card-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .small-game-card-body {
      padding: 1rem;
      flex-grow: 1;
    }
    
    .small-game-card-title {
      font-size: 1rem;
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 0.5rem;
    }
    
    .small-game-card-text {
      font-size: 0.9rem;
      color: #555;
      margin-bottom: 0.75rem;
    }
    
    .small-game-card-btn {
      background-color: var(--primary-color);
      color: white;
      border: none;
      border-radius: 30px;
      padding: 0.25rem 1rem;
      font-size: 0.9rem;
      transition: background-color 0.2s ease;
    }
    
    .small-game-card-btn:hover {
      background-color: #0a2e62;
      color: white;
    }
    
    /* Leaderboard Preview */
    .leaderboard-preview {
      background-color: white;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      padding: 1.5rem;
      margin-bottom: 3rem;
    }
    
    .leaderboard-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid #eee;
    }
    
    .leaderboard-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--primary-color);
      margin: 0;
    }
    
    .leaderboard-item {
      display: flex;
      align-items: center;
      padding: 0.75rem 0;
      border-bottom: 1px solid #f5f5f5;
    }
    
    .leaderboard-item:last-child {
      border-bottom: none;
    }
    
    .leaderboard-rank {
      font-weight: 600;
      color: var(--primary-color);
      width: 30px;
      text-align: center;
    }
    
    .leaderboard-user {
      flex-grow: 1;
      padding: 0 1rem;
    }
    
    .leaderboard-name {
      font-weight: 500;
    }
    
    .leaderboard-stats {
      font-size: 0.8rem;
      color: #6c757d;
    }
    
    .leaderboard-score {
      font-weight: 600;
      color: var(--primary-color);
    }
    
    .view-all-btn {
      display: inline-block;
      margin-top: 1rem;
      color: var(--primary-color);
      font-weight: 500;
      text-decoration: none;
    }
    
    /* Section Styling */
    .section-header {
      text-align: center;
      margin-bottom: 3rem;
    }
    
    .section-title {
      font-size: 2rem;
      font-weight: 700;
      color: var(--primary-color);
      margin-bottom: 1rem;
    }
    
    .section-subtitle {
      color: #6c757d;
      max-width: 700px;
      margin: 0 auto;
    }
    
    /* Help Modal */
    .help-modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
    }
    
    .help-modal-content {
      background-color: white;
      margin: 5% auto;
      padding: 2rem;
      border-radius: 8px;
      max-width: 700px;
      width: 90%;
      position: relative;
    }
    
    .close-help {
      position: absolute;
      top: 1rem;
      right: 1rem;
      font-size: 1.5rem;
      cursor: pointer;
      color: #6c757d;
    }
    
    .help-btn {
      position: fixed;
      bottom: 30px;
      right: 30px;
      background-color: var(--primary-color);
      color: white;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.25rem;
      cursor: pointer;
      z-index: 999;
      transition: background-color 0.2s ease;
    }
    
    .help-btn:hover {
      background-color: #0a2e62;
    }
    
    /* Loading State */
    .loading-container {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 2rem;
    }
    
    .loading-spinner {
      width: 50px;
      height: 50px;
      border: 5px solid rgba(14, 59, 125, 0.2);
      border-radius: 50%;
      border-top-color: var(--primary-color);
      animation: spin 1s ease-in-out infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* Responsive Adjustments */
    @media (max-width: 992px) {
      .game-card-img-container {
        height: 240px;
      }
    }
    
    @media (max-width: 768px) {
      .hero-content h1 {
        font-size: 2rem;
      }
      
      .hero-subtitle {
        font-size: 1rem;
      }
      
      .section-title {
        font-size: 1.75rem;
      }
      
      .game-card-img-container {
        height: 200px;
      }
    }
    
    @media (max-width: 576px) {
      .hero-section {
        padding: 3rem 0;
      }
      
      .hero-content h1 {
        font-size: 1.75rem;
      }
      
      .small-game-card {
        flex-direction: column;
      }
      
      .small-game-card-img-container {
        width: 100%;
        height: 150px;
      }
    }
  </style>
</head>
        
<body>
  <!-- Header -->
  <header class="mnthen-header">
    <div class="mnthen-header-container">
      <a href="/" class="mnthen-logo">
        <img src="https://www.mnthen.com/images/logo.webp" alt="Minnesota Then Logo" class="mnthen-logo-img" /> 
        Minnesota Then
      </a>
      
      <button class="mnthen-mobile-menu" aria-label="Toggle menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
      
      <nav class="mnthen-nav">
        <ul class="mnthen-nav-list">
          <li class="mnthen-nav-item">
            <button class="mnthen-dropdown-btn">
              About
              <svg class="mnthen-dropdown-arrow" viewBox="0 0 24 24" width="16" height="16">
                <path d="M7 10l5 5 5-5z"/>
              </svg>
            </button>
            <div class="mnthen-dropdown-content">
              <a href="https://mnthen.com/mission.html">Mission</a>
              <a href="https://mnthen.com/ourteam.html">Our Team</a>
              <a href="https://mnthen.com/contact">Contact</a>
            </div>
          </li>
          <li class="mnthen-nav-item">
            <button class="mnthen-dropdown-btn">
              Multimedia
              <svg class="mnthen-dropdown-arrow" viewBox="0 0 24 24" width="16" height="16">
                <path d="M7 10l5 5 5-5z"/>
              </svg>
            </button>
            <div class="mnthen-dropdown-content">
              <a href="https://mnthen.com/blog.html">Blog</a>
              <a href="https://www.youtube.com/@mnthen" target="_blank">YouTube</a>
              <a href="https://mnthen.com/podcast.html">Podcast</a>
            </div>
          </li>
          <li class="mnthen-nav-item">
            <button class="mnthen-dropdown-btn">
              Resources
              <svg class="mnthen-dropdown-arrow" viewBox="0 0 24 24" width="16" height="16">
                <path d="M7 10l5 5 5-5z"/>
              </svg>
            </button>
            <div class="mnthen-dropdown-content">
              <a href="https://mnthen.com/faq.html">Help Center</a>
              <a href="https://mnthen.com/upcoming_events.html">Upcoming Events</a>
              <a href="https://mnthen.com/resources.html">Research Tools</a>
            </div>
          </li>
          <li class="mnthen-nav-item">
            <button class="mnthen-dropdown-btn">
              Interact
              <svg class="mnthen-dropdown-arrow" viewBox="0 0 24 24" width="16" height="16">
                <path d="M7 10l5 5 5-5z"/>
              </svg>
            </button>
            <div class="mnthen-dropdown-content">
              <a href="https://www.patreon.com/mnthen" target="_blank">Join Our Patreon</a>
              <a href="https://mnthen.com/markers.html">Share Your Story</a>
              <a href="https://mnthen.com/trivia.html">Play Trivia Games</a> 
            </div>
          </li>
          <li class="mnthen-nav-item">
            <a href="https://mnthen.com/donate.html" class="mnthen-donate-btn">Donate</a>
          </li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- Hero Section -->
  <section class="hero-section">
    <div class="hero-content">
      <h1>Minnesota History Trivia</h1>
      <p class="hero-subtitle">Test your knowledge of Minnesota's rich past and compete with other history enthusiasts</p>
    </div>
  </section>

  <!-- Search Section -->
  <section class="search-section">
    <div class="container">
      <div class="search-container">
        <input type="text" id="searchInput" class="search-input" placeholder="Search trivia games..." aria-label="Search trivia games">
        <button id="searchButton" class="search-button" aria-label="Search">
          <i class="fas fa-search"></i>
        </button>
      </div>
    </div>
  </section>

  <main class="container py-5">
    <!-- Main Games Section -->
    <section>
      <div class="section-header">
        <h2 class="section-title">Featured Trivia Games</h2>
        <p class="section-subtitle">Challenge yourself with our Minnesota history quizzes</p>
      </div>
      
      <div class="row g-4" id="main-games-container">
        <div class="loading-container">
          <div class="loading-spinner"></div>
        </div>
      </div>
    </section>

    <!-- Additional Games Section -->
    <section class="mt-5">
      <div class="section-header">
        <h2 class="section-title">More Trivia Games</h2>
        <p class="section-subtitle">Explore our full collection of history challenges</p>
      </div>
      
      <div class="row">
        <div class="col-md-6" id="additional-games-container">
          <div class="loading-container">
            <div class="loading-spinner"></div>
          </div>
        </div>
        <div class="col-md-6">
          <!-- Leaderboard Preview -->
          <div class="leaderboard-preview">
            <div class="leaderboard-header">
              <h3 class="leaderboard-title"><i class="fas fa-trophy me-2"></i>Top Players</h3>
              <a href="#" class="view-all-btn" onclick="openLeaderboard('highScore')">View All</a>
            </div>
            
            <div id="leaderboard-preview-container">
              <div class="loading-container">
                <div class="loading-spinner"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Help Button -->
  <div class="help-btn" id="helpBtn">
    <i class="fas fa-question"></i>
  </div>

  <!-- Help Modal -->
  <div id="helpModal" class="help-modal">
    <div class="help-modal-content">
      <span class="close-help">&times;</span>
      <h3>How to Play Minnesota History Trivia</h3>
      <p>Our trivia games are designed to test your knowledge of Minnesota's rich history while being fun and educational.</p>
      
      <h5 class="mt-4">Getting Started</h5>
      <ol>
        <li>Select any trivia game from our collection</li>
        <li>Each game consists of 10 multiple-choice questions</li>
        <li>Read each question carefully and select your answer</li>
      </ol>
      
      <h5 class="mt-4">Scoring</h5>
      <ul>
        <li>Each correct answer earns you 10 points</li>
        <li>Points are added to your all-time total</li>
        <li>Your highest score in a single game is tracked</li>
      </ul>
      
      <h5 class="mt-4">Leaderboards</h5>
      <p>Compete with other players on our leaderboards for high scores, all-time points, and most games played.</p>
      
      <div class="text-center mt-4">
        <button class="game-card-btn" onclick="closeHelpModal()">Got It!</button>
      </div>
    </div>
  </div>

  <!-- Floating Action Button (FAB) -->
  <a href="https://www.mnthen.com/index.html" class="mnthen-fab" aria-label="Return to Front Page">
    <i class="fas fa-home"></i>
    <span class="mnthen-fab-tooltip">Back to the Home Page</span>
  </a>

  <!-- Footer -->
  <footer class="footer bg-primary py-5"> 
    <div class="container">
      <div class="row g-4 mb-4">
          <div class="col-lg-3 col-md-6 pt-3">
              <h3 class="footer-brand mb-3">
                  <span class="text-white">Minnesota</span>
                  <span class="text-navy">Then</span>
              </h3>
          </div>
          <div class="col-lg-2 col-md-6">
              <h5 class="text-white mb-3">Who We Are</h5>
              <ul class="list-unstyled footer-links">
                  <li><a href="/about.html">About Us</a></li>
                  <li><a href="/privacy_terms.html">ToS & Privacy</a></li>
              </ul>
          </div>
          <div class="col-lg-2 col-md-6">
              <h5 class="text-white mb-3">What We Do</h5>
              <ul class="list-unstyled footer-links">
                  <li><a href="https://mnthen.com/blog.html">Blog</a></li>
                  <li><a href="https://www.mnthen.com/article/thesis_project.pdf">Thesis Project</a></li>
                  <li><a href="/upcoming_events.html">Upcoming Events</a></li>
              </ul>
          </div>
          <div class="col-lg-2 col-md-6">
              <h5 class="text-white mb-3">Resources</h5>
              <ul class="list-unstyled footer-links">
                  <a href="https://github.com/mreicher/MNThen/" target="_blank" rel="noopener noreferrer">GitHub</a>
                  <li><a href="/faq.html">Help Center</a></li>
                  <li><a href="/resources.html">Research Tools</a></li>
              </ul>
          </div>
          <div class="col-lg-3 col-md-6 pt-3">
              <p class="tagline">Every Step Tells a Story</p>
          </div>
      </div>
      <hr class="footer-divider">
      <div class="row align-items-center">
        <div class="col-md-4 text-center text-md-start">
          <small style="color: white;">&copy; 2025 Minnesota Then. All rights reserved</small>
        </div>
        <div class="col-md-8">
          <div class="social-icons text-center text-md-end">
            <span class="me-2" style="color: white;">Connect:</span>
            <a href="https://www.facebook.com/profile.php?id=100090355652945" target="_blank" class="text-white" rel="noreferrer">
              <i class="fab fa-facebook-f"></i>
            </a>
            <span class="mx-2 text-white">|</span>
            <a href="https://bsky.app/profile/mnthen.bsky.social" target="_blank" class="text-white" rel="noreferrer">
              <i class="fa-brands fa-bluesky"></i>
            </a>
            <span class="mx-2 text-white">|</span>
            <a href="https://www.linkedin.com/company/minnesota-then" target="_blank" class="text-white" rel="noreferrer">
              <i class="fab fa-linkedin-in"></i>
            </a>
          </div>
        </div>
      </div>
    </div>
  </footer>

  <!-- JavaScript -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  
  <script>
    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyBDUAF3qJGhLYQJPHyWwY0JzonN5l8ERzE",
      authDomain: "mnthen-3151d.firebaseapp.com",
      projectId: "mnthen-3151d",
      storageBucket: "mnthen-3151d.appspot.com",
      messagingSenderId: "416231360428",
      appId: "1:416231360428:web:36f69cc231be2d84a8dc09",
      databaseURL: "https://mnthen-3151d-default-rtdb.firebaseio.com"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    document.addEventListener('DOMContentLoaded', function() {
      // Initialize navigation
      initializeNavigation();
      
      // Initialize help modal
      initializeHelpModal();
      
      // Initialize search functionality
      initializeSearch();
      
      // Load games and leaderboard
      loadGames();
      loadLeaderboardPreview();
    });

    function initializeNavigation() {
      const mobileMenuBtn = document.querySelector('.mnthen-mobile-menu');
      const mainNav = document.querySelector('.mnthen-nav');
      const dropdownBtns = document.querySelectorAll('.mnthen-dropdown-btn');

      if (mobileMenuBtn && mainNav) {
        mobileMenuBtn.addEventListener('click', function(e) {
          e.stopPropagation();
          this.classList.toggle('active');
          mainNav.classList.toggle('active');
        });

        dropdownBtns.forEach(btn => {
          ['click', 'touchstart'].forEach(eventType => {
            btn.addEventListener(eventType, function(e) {
              e.preventDefault();
              e.stopPropagation();
              
              dropdownBtns.forEach(otherBtn => {
                if (otherBtn !== btn) {
                  otherBtn.classList.remove('active');
                  otherBtn.nextElementSibling?.classList.remove('active');
                }
              });
              
              this.classList.toggle('active');
              const dropdownContent = this.nextElementSibling;
              if (dropdownContent) {
                dropdownContent.classList.toggle('active');
              }
            });
          });
        });
      }

      // Close dropdowns when clicking outside
      ['click', 'touchstart'].forEach(eventType => {
        document.addEventListener(eventType, function(e) {
          const isClickInsideNav = e.target.closest('.mnthen-nav');
          const isClickInsideMenu = e.target.closest('.mnthen-mobile-menu');

          if (!isClickInsideNav && !isClickInsideMenu) {
            mainNav?.classList.remove('active');
            mobileMenuBtn?.classList.remove('active');
            dropdownBtns.forEach(btn => {
              btn.classList.remove('active');
              btn.nextElementSibling?.classList.remove('active');
            });
          }
        });
      });

      // Handle window resize
      window.addEventListener('resize', function() {
        if (window.innerWidth > 768) {
          mainNav?.classList.remove('active');
          mobileMenuBtn?.classList.remove('active');
          dropdownBtns.forEach(btn => {
            btn.classList.remove('active');
            btn.nextElementSibling?.classList.remove('active');
          });
        }
      });
    }

    function initializeHelpModal() {
      const helpBtn = document.getElementById('helpBtn');
      const helpModal = document.getElementById('helpModal');
      const closeHelp = document.querySelector('.close-help');

      helpBtn.addEventListener('click', function() {
        helpModal.style.display = 'block';
      });

      closeHelp.addEventListener('click', function() {
        helpModal.style.display = 'none';
      });

      window.addEventListener('click', function(event) {
        if (event.target === helpModal) {
          helpModal.style.display = 'none';
        }
      });
    }

    function closeHelpModal() {
      document.getElementById('helpModal').style.display = 'none';
    }

    function initializeSearch() {
      const searchInput = document.getElementById('searchInput');
      const searchButton = document.getElementById('searchButton');

      function performSearch() {
        const searchTerm = searchInput.value.toLowerCase();
        const allCards = document.querySelectorAll('.game-card, .small-game-card');
        
        allCards.forEach(card => {
          const title = card.querySelector('.game-card-title, .small-game-card-title').textContent.toLowerCase();
          const text = card.querySelector('.game-card-text, .small-game-card-text')?.textContent.toLowerCase() || '';
          
          if (title.includes(searchTerm) || text.includes(searchTerm)) {
            card.style.display = '';
            card.parentElement.style.display = '';
          } else {
            card.style.display = 'none';
            card.parentElement.style.display = 'none';
          }
        });
      }

      searchInput.addEventListener('input', performSearch);
      searchButton.addEventListener('click', performSearch);
    }

    function loadGames() {
      // Reference to your games in Firebase
      const gamesRef = database.ref('triviaGames');
      
      gamesRef.once('value').then((snapshot) => {
        const games = snapshot.val();
        const mainGamesContainer = document.getElementById('main-games-container');
        const additionalGamesContainer = document.getElementById('additional-games-container');
        
        mainGamesContainer.innerHTML = '';
        additionalGamesContainer.innerHTML = '';
        
        if (!games) {
          mainGamesContainer.innerHTML = '<p class="text-center">No games available at this time.</p>';
          return;
        }
        
        // Convert games object to array
        const gamesArray = Object.values(games);
        
        // Display first 3 games as main cards
        gamesArray.slice(0, 3).forEach(game => {
          mainGamesContainer.innerHTML += createMainGameCard(game);
        });
        
        // Display remaining games as small cards
        if (gamesArray.length > 3) {
          gamesArray.slice(3).forEach(game => {
            additionalGamesContainer.innerHTML += createSmallGameCard(game);
          });
        } else {
          additionalGamesContainer.innerHTML = '<p class="text-muted">More games coming soon!</p>';
        }
      }).catch((error) => {
        console.error('Error loading games:', error);
        document.getElementById('main-games-container').innerHTML = '<p class="text-center">Error loading games. Please try again later.</p>';
      });
    }

    function createMainGameCard(game) {
      return `
        <div class="col-lg-4 col-md-6">
          <div class="game-card">
            <div class="game-card-img-container">
              <img src="${game.image}" class="game-card-img" alt="${game.title}">
            </div>
            <div class="game-card-body">
              <h3 class="game-card-title">${game.title}</h3>
              <p class="game-card-text">${game.description}</p>
            </div>
            <div class="game-card-footer">
              <div class="game-card-stats"><i class="fas fa-question-circle me-1"></i> 10 questions</div>
              <a href="${game.url}" class="game-card-btn">Play Now</a>
            </div>
          </div>
        </div>
      `;
    }

    function createSmallGameCard(game) {
      return `
        <div class="small-game-card">
          <div class="small-game-card-img-container">
            <img src="${game.image}" class="small-game-card-img" alt="${game.title}">
          </div>
          <div class="small-game-card-body">
            <h4 class="small-game-card-title">${game.title}</h4>
            <p class="small-game-card-text">${game.description}</p>
            <a href="${game.url}" class="small-game-card-btn">Play</a>
          </div>
        </div>
      `;
    }

    function loadLeaderboardPreview() {
      const leaderboardContainer = document.getElementById('leaderboard-preview-container');
      
      database.ref('users')
        .orderByChild('highScore')
        .limitToLast(3)
        .once('value')
        .then((snapshot) => {
          leaderboardContainer.innerHTML = '';
          
          if (!snapshot.exists()) {
            leaderboardContainer.innerHTML = '<p class="text-muted">No players yet</p>';
            return;
          }

          const users = [];
          snapshot.forEach((childSnapshot) => {
            const user = childSnapshot.val();
            if (user.highScore > 0) {
              users.push(user);
            }
          });

          if (users.length === 0) {
            leaderboardContainer.innerHTML = '<p class="text-muted">No scores yet</p>';
            return;
          }

          // Sort in descending order
          users.sort((a, b) => (b.highScore || 0) - (a.highScore || 0));

          users.forEach((user, index) => {
            const rank = index + 1;
            const scoreValue = user.highScore || 0;
            const firstInitial = user.firstName ? user.firstName.charAt(0).toUpperCase() : 'U';
            const lastName = user.lastName || 'Player';
            
            leaderboardContainer.innerHTML += `
              <div class="leaderboard-item">
                <div class="leaderboard-rank">${rank}</div>
                <div class="leaderboard-user">
                  <div class="leaderboard-name">${firstInitial}. ${lastName}</div>
                  <div class="leaderboard-stats">Games: ${user.gamesPlayed || 0}</div>
                </div>
                <div class="leaderboard-score">${scoreValue} pts</div>
              </div>
            `;
          });
        })
        .catch((error) => {
          console.error('Error loading leaderboard:', error);
          leaderboardContainer.innerHTML = '<p class="text-muted">Error loading leaderboard</p>';
        });
    }

    function openLeaderboard(type) {
      const width = Math.min(window.innerWidth * 0.9, 1000);
      const height = Math.min(window.innerHeight * 0.9, 800);
      const left = (window.innerWidth - width) / 2;
      const top = (window.innerHeight - height) / 2;
      
      const features = `width=${width},height=${height},left=${left},top=${top},resizable=yes,scrollbars=yes`;
      window.open('leaderboard.html?type=' + type, 'leaderboard', features);
    }
  </script>
</body>
</html>
