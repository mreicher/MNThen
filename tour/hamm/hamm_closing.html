<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Minnesota Then</title>
  <link rel="shortcut icon" type="image/jpg" href="/images/mnthenfav.ico">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.plyr.io/3.6.8/plyr.css" />
  <link rel="stylesheet" type="text/css" href="https://www.mnthen.com/css/location.css">
  <script src="https://cdn.plyr.io/3.6.8/plyr.js"></script>
</head>
<body>

<div class="container-fluid p-0">
  <div class="hero-gallery">

    <img src="" alt="Hero Image" class="img-fluid">

  </div>
</div>

<div class="summary-container">

  <div class="summary-box">

    <p></p>

  </div>

  <div class="controls">
   
        <button class="btn btn-lg btn-primary" id="prev-btn">Back</button>

  <button class="btn btn-lg btn-primary" id="next-btn">Next</button>

</div>
</div>

  <section class="content-section">
    <div class="content-container">
       <h2 class="title">Closing of the Stroh Brewery (1997)</h2>

<div class="author-container">

  <p>By: <span style="color: blue;">Matt Reicher</span></p>

</div>

      <p class="summary">Stroh's Brewery closed the historic Hamm's Brewery in St. Paul in 1997, leaving hundreds unemployed. Efforts to keep the brewery failed, but the community fought to preserve its historical significance. In 2023, JB Vang Partners was granted tentative developer status for its redevelopment.</p>

      <p></p>

<audio id="audio-player" controls>

        <source src="https://www.mnthen.com/audio/hamm_closing.mp3" type="audio/mpeg">

  Your browser does not support the audio element.
</audio>
    </div>
  </section>
<div class="location-marker">
  <button id="mark-visited-btn" class="btn btn-primary">Return to the Map</button>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js"></script>
<script src="https://cdn.plyr.io/3.6.8/plyr.polyfilled.js"></script>
<script>
function deg2rad(deg) {
  return deg * (Math.PI / 180);
}

function getDistanceFromLatLonInFeet(lat1, lon1, lat2, lon2) {
  const R = 20908800;
  const dLat = deg2rad(lat2 - lat1);
  const dLon = deg2rad(lon2 - lon1);
  const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
            Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *
            Math.sin(dLon / 2) * Math.sin(dLon / 2);
  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
  const d = R * c;
  return d;
}

$(document).ready(function() {
  var images = [
    "https://www.mnthen.com/tour/hamm/gallery/closing/hamm_closing1.jpg",
    "https://www.mnthen.com/tour/hamm/gallery/closing/hamm_closing2.jpg",
  ];
  var summaries = [
    "A view of the Stroh Brewery from Minnehaha Ave. East in Saint Paul",
    "Looking down Minnehaha Ave. East toward Payne Ave.",
  ];
  var sources = [
    "<a href='https://web.archive.org/web/20221208095343/https://mnthen.com/closing-of-strohs-hamms-brewery-in-st-paul/' target='_blank'>Web Archive</a>",
    "<a href='https://pin.it/57hdUXI' target='_blank'>Pinterest | Rick Hansen</a>",
  ];
  var currentIndex = 0;

  function showImage(index) {
    $('.hero-gallery img').attr('src', images[index]);
    $('.summary-box p').html(summaries[index] + ' ' + sources[index]);
  }

  function updateGallery() {
    showImage(currentIndex);
  }

  $('.controls button').on('click', function() {
    var id = $(this).attr('id');
    if (id === 'prev-btn') {
      currentIndex = (currentIndex - 1 + images.length) % images.length;
    } else if (id === 'next-btn') {
      currentIndex = (currentIndex + 1) % images.length;
    }
    updateGallery();
  });

  updateGallery();

  function updateDistance(latitude, longitude) {
  const centerLat = 44.9626001898243; // Center latitude
  const centerLong = -93.070360323737; // Center longitude

    const distance = getDistanceFromLatLonInFeet(latitude, longitude, centerLat, centerLong);

    const visitedCheckbox = document.getElementById('visited-checkbox');
    if (visitedCheckbox.checked) {
      window.location.href = '/tour/hamm/hamm_map.html';
    }
  }

  $('#mark-visited-btn').on('click', function() {
    const visitedButton = $(this);
    visitedButton.prop('disabled', true);
    setTimeout(function() {
      window.location.href = 'map.html';
    }, 1000);
  });

  function getLocation() {
    if (navigator.geolocation) {
      navigator.geolocation.watchPosition(
        (position) => {
          const latitude = position.coords.latitude;
          const longitude = position.coords.longitude;
          updateDistance(latitude, longitude);
        },
        () => {
          alert("Unable to retrieve location.");
        }
      );
    } else {
      alert("Geolocation is not supported by this browser.");
    }
  }

  const player = new Plyr('#audio-player', {
    controls: ['play', 'progress', 'current-time'],
    iconUrl: 'https://cdn.plyr.io/3.6.8/plyr.svg',
    blankUrl: 'https://cdn.plyr.io/3.6.8/blank.mp4',
    tooltips: {
      controls: false,
    },
    i18n: {
      play: 'Play',
      pause: 'Pause',
    },
  });

});
</script>
</body>
</html>
